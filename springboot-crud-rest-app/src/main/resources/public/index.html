<!DOCTYPE html>
<html ng-app="homeApp" lang="en" xmlns:th="http://www.thymeleaf.org">
  <title>Home</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="/css/bootstrap.min.css">
 <link rel="stylesheet" href="/css/jquery.dataTables.min.css">
 <link rel="stylesheet" href="/css/buttons.dataTables.min.css"> 
<!-- datetimepicker plugin -->
 <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.37/css/bootstrap-datetimepicker.css"> -->
<link rel="stylesheet" href="/css/tempusdominus-bootstrap-4.min.css" />
 <link rel="stylesheet" href="/css/font-awesome.min.css"> 
 <link rel="stylesheet" href="/css/angular-toastr.css" />
<link rel="stylesheet" type="text/css" href="/css/fixedColumns.dataTables.css"/>
<link rel="stylesheet" type="text/css" href="/css/fixedHeader.dataTables.css"/>
<link rel="stylesheet" type="text/css" href="/css/select.dataTables.css"/>


  <script src="/js/jquery.min.js"></script>
  <script src = "/js/jquery.dataTables.min.js"></script>
  
  <script src="/js/bootstrap.min.js"></script>
<script src="/js/angular.min.js"></script>
<script src="/js/angular-resource.js"></script>
<script type="text/javascript" src="/js/angular-datatables.min.js"></script>
 <script src="/js/angular-route.js"></script> 
 <script src="/js/angular-filter.min.js"></script>
<!-- <script src="/js/angular-ui-router.min.js"></script> -->

<script src="/js/angular-animate.js"></script>

<script src="/js/moment.js"></script>
<script type="text/javascript" src="/js/tempusdominus-bootstrap-4.min.js"></script>


<script src="/js/dataTables.buttons.min.js"></script>
<script src="/js/buttons.colVis.min.js"></script>
<script src="/js/buttons.flash.min.js"></script>
<script src="/js/jszip.min.js"></script>
<script src="/js/pdfmake.min.js"></script>
<script src="/js/vfs_fonts.js"></script>
<script src="/js/buttons.html5.min.js"></script>
<script src="/js/buttons.print.min.js"></script>
<script src="/js/dataTables.select.js"></script>
<script type="text/javascript" src="/js/dataTables.fixedColumns.js"></script> 
<script type="text/javascript" src="/js/dataTables.fixedHeader.js"></script>
<script type="text/javascript" src="/js/dataTables.lightColumnFilter.min.js"></script>

<script type="text/javascript"src="/js/angular-datatables.select.min.js"></script>
<script src="/js/angular-datatables.fixedcolumns.js"></script>
<script src="/js/angular-datatables.buttons.min.js"></script>
 <script type="text/javascript" src="/js/angular-datatables.light-columnfilter.min.js"></script> 




<script src="/js/angular-toastr.tpls.js"></script>



<style>

.card{
transition: transform .2s;
}
.card:hover{
	
	transform: scale(1.1);
}

@media (min-width:480px)  {
 .container{
    margin-left: 12%;
}
}
@media (min-width:320px)  {
 .container{
    width: 100%;
    height: 100%;
}
}

input[name=username] {
  width: 100%;
  border: 0;
  outline: 0;
  padding: 0.5rem 0;
  border-bottom: 2px solid #e2d9d9;
  box-shadow: none;
  color: #111;
}
input[type=password] {
  width: 100%;
  border: 0;
  outline: 0;
  padding: 0.5rem 0;
  border-bottom: 2px solid #e2d9d9;
  box-shadow: none;
  color: #111;
}
.input-field {
  position: relative;
  width: 250px;
  height: 44px;
  line-height: 44px;
}

.textspan {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  color: #d3d3d3;
  transition: 0.2s all;
  cursor: text;
}
.passSpan {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  color: #d3d3d3;
  transition: 0.2s all;
  cursor: text;
}
input[name=username] :invalid {
  outline: 0;

}
input[name=username]:focus,
input[name=username]:valid {
  border-color: #e2d9d9;
}
input[name=username]:focus~.textspan,
input[name=username]:valid~.textspan {
  font-size: 14px;
  top: -24px;
  color: #e2d9d9;
}

input[name=password] :invalid {
  outline: 0;
  
}
input[name=password]:focus,
input[name=password]:valid {
  border-color: #e2d9d9;
}
input[name=password]:focus~.passSpan,
input[name=password]:valid~.passSpan {
  font-size: 14px;
  top: -24px;
  color: #e2d9d9;
}



/*login css end*/




html,body{
width:100% !important;
height:100% !important;
overflow: hidden;
font-family: Arial !important;
font-size:12px;
}
.card {
  width: 300px;
}


#wrapper {
    padding-left: 70px;
    transition: all .4s ease 0s;
    height: 100%
}

#sidebar-wrapperMain {
    margin-left: -150px;
    left: 50px;
    width: 150px;
    background: #222;
    position: fixed;
    height: 100%;
    z-index: 10000;
    transition: all .4s ease 0s;
}
.sidebar-nav {
    display: block;
    float: left;
    width: 150px;
    list-style: none;
    margin: 0;
    padding: 0;
}
#page-content-wrapper {
    padding-left: 0;
    margin-left: 0;
    width: 100%;
    height: auto;
}
#wrapper.active {
    padding-left: 150px;
}
#wrapper.active #sidebar-wrapperMain {
    left: 150px;
}

#page-content-wrapper {
  width: 100%;
}

#sidebar_menu li a, .sidebar-nav li a {
    color: #999;
    display: block;
    float: left;
    text-decoration: none;
    width: 150px;
    background: #252525;
    border-top: 1px solid #373737;
    border-bottom: 1px solid #1A1A1A;
    -webkit-transition: background .5s;
    -moz-transition: background .5s;
    -o-transition: background .5s;
    -ms-transition: background .5s;
    transition: background .5s;
}
.sidebar_name {
    padding-top: 25px;
    color: #fff;
    opacity: .7;
}

.sidebar-nav li {
  line-height: 40px;
  text-indent: 20px;
}

.sidebar-nav li a {
  color: #999999;
  display: block;
  text-decoration: none;
}

.sidebar-nav li a:hover {
  color: #fff;
  background: rgba(255,255,255,0.2);
  text-decoration: none;
}

.sidebar-nav li a:active,
.sidebar-nav li a:focus {
  text-decoration: none;
}

.sidebar-nav > .sidebar-brand {
	height: 43px;
    line-height: 43px;
    font-size: 15px;;
}

.sidebar-nav > .sidebar-brand a {
  color: #999999;
}

.sidebar-nav > .sidebar-brand a:hover {
  color: #fff;
  background: none;
}

#main_icon
{
    float:right;
   padding-right: 35px;
   padding-top:20px;
}
.sub_icon
{
    float: right;
    padding-right: 21px;
    padding-top: 15px;
    color: orange;
}
.content-header {
  height: 65px;
  line-height: 65px;
}

.content-header h1 {
  margin: 0;
  margin-left: 20px;
  line-height: 65px;
  display: inline-block;
}

@media (max-width:767px) {
    #wrapper {
    padding-left: 70px;
    transition: all .4s ease 0s;
}
#sidebar-wrapperMain {
    left: 70px;
}
#wrapper.active {
    padding-left: 150px;
}
#wrapper.active #sidebar-wrapperMain {
    left: 150px;
    width: 150px;
    transition: all .4s ease 0s;
}
}
.labelfont{
    font-weight: bold;
}
div.dt-buttons{
    margin-left: 5% !important;
}
.filterDiv{
    border: 1px solid #c1bebe;
    border-radius: 10px;
    padding: 1%;
    margin-top: 1%;
    background-image: linear-gradient(to right top, #2c64b7, #008fce, #00b2bc, #41cf94, #c0e176);
}
/*
.tab-content{
overflow:auto;  
height: calc(100vh - 42px); 
height: -webkit-calc(100vh - 42px);
height: -moz-calc(100vh - 42px);
}*/
.tab-content>.active {
    overflow: auto;
    height: calc(100vh - 80px);
    height: -webkit-calc(100vh - 80px);
    height: -moz-calc(100vh - 80px);
}
/* file upload */

.files{ 
    position:relative;
    border: 3px dashed #0142fe;
    text-align: center;
    margin: 0;
    width: 100% !important;
    height:170px;
    overflow:hidden;
    background-color: white;
}

.files input {
    width: 100% !important;
    height:130px;
    border:none;
    padding:0;
    background:transparent;
    text-align:center;
}

.files{ position:relative}

.files:after {
    pointer-events: none;
    position: absolute;
    top: 36px;
    left: 0;
    width: 70px;
    right: 0;
    height: 70px;
    content: "";
    background-image: url(https://image.flaticon.com/icons/svg/130/130993.svg);
    display: block;
    margin: 0 auto;
    background-size: 100%;
    background-repeat: no-repeat;
}

.files:before {
  content:"Browse or Drag file here";
  position:absolute;
  bottom:36px;
  left:0;
  right:0;
  display:block;
  text-align:center;
  color:#0142fe;
  font-weight:bold;
}

/* file upload css end */
.labeltext{
    text-align: center;
    font-weight: bold
}

.textCenter{
text-align: center;
}

fieldset {
	/* background-color: rgba(111, 66, 193, 0.3); */
	background-image: linear-gradient(to right top, #2c64b7, #008fce, #00b2bc, #41cf94, #c0e176);
	border-radius: 4px;
}

legend {
	background-color: #fff;
	border: 1px solid #ddd;
	border-radius: 4px;
	color: var(--purple);
	font-size: 17px;
	font-weight: bold;
	padding: 3px 5px 3px 7px;
	width: auto;
}
#manage-billing-table th,
  #manage-billing-table td {
      white-space: nowrap;
  }
  #manage-billing-table_wrapper.dataTables_wrapper {
      width: 90%;
      margin: 0 auto;
      overflow:auto;
  }
 
 #manage-vendor-table th,
  #manage-vendor-table td {
      white-space: nowrap;
  }
  #manage-vendor-table_wrapper.dataTables_wrapper {
      width: 90%;
      margin: 0 auto;
      overflow:auto;
  }

 #manage-custPayment-table th,
  #manage-custPayment-table td {
      white-space: nowrap;
  }
  #manage-custPayment-table_wrapper.dataTables_wrapper {
      width: 90%;
      margin: 0 auto;
      overflow:auto;
  }
 
  #manage-venPayment-table th,
  #manage-venPayment-table td {
      white-space: nowrap;
  }
  #manage-venPayment-table_wrapper.dataTables_wrapper {
      width: 90%;
      margin: 0 auto;
      overflow:auto;
  }
 .mandatory{
 color:red;
 font-weight: bold;
 font-size: large;
 }
</style>
<body >

<div ng-controller="indexController" style="width: 100%;height: 100%;">

<!--Navbar ng-controller="indexController" -->
 <nav class = "navbar navbar-expand-sm bg-primary navbar-dark" style="background-image: radial-gradient(circle, #777886, #7f8b92, #768586, #66716b, #606f71eb);">
            <a class = "navbar-brand" href = "#">
               <img src = "img/sse.png" 
                  style="width: 73px;height: 28px;" alt = "">
            </a>
            <ul class = "navbar-nav ml-auto">
              
                <li class="nav-item dropdown">
		        <a class="nav-link dropdown-toggle" id="navbarDropdownMenuLink-4" data-toggle="dropdown"
		          aria-haspopup="true" aria-expanded="false">
		          <i class="fa fa-user-circle"></i> Profile </a>
		        <div class="dropdown-menu dropdown-menu-right dropdown-info" aria-labelledby="navbarDropdownMenuLink-4">
		          <a class="dropdown-item" href="#">My account</a>
		          <a class="dropdown-item" href="#">Log out</a>
		        </div>
		      </li>
 
            </ul>
            
         </nav>

<div id="wrapper" class="active">
      
      <!-- Sidebar -->
      <div id="sidebar-wrapperMain">
      <ul id="sidebar_menu" class="sidebar-nav">
           <li class="sidebar-brand"><a class="menu-toggle" id="home" ng-click="redirectUrl($event)" href="#">Home<i class="fa fa-bars sub_icon" aria-hidden="true"></i></a></li>
      </ul>
      <ul  class="sidebar-nav">  
	  <li class="sidebar-brand"><a id="customer_master"  ng-click="redirectUrl($event)">Customer<i class="fa fa-user sub_icon" aria-hidden="true"></i></a></li>
      <li class='sidebar-brand'><a id="vendor_master"   ng-click="redirectUrl($event)">Vendor<i class="fa fa-user-circle sub_icon"></i></a></li> 
      <li class='sidebar-brand' ><a id="employee_master" ng-click="redirectUrl($event)">Employee<i class="fa fa-users sub_icon" aria-hidden="true"></i></a></li> 
      <!-- <li class='sidebar-brand' ><a id="product_master"  ng-click="redirectUrl($event)">Product<i class="fa fa-product-hunt sub_icon" aria-hidden="true"></i></a></li> --> 
      <li class='sidebar-brand'><a id="vehicle_master"  ng-click="redirectUrl($event)">TripSheet<i class="fa fa-truck sub_icon" aria-hidden="true"></i></a></li>
      <li class='sidebar-brand' ><a id="user_master"  ng-click="redirectUrl($event)">User<i class="fa fa-user sub_icon" aria-hidden="true"></i></a></li>
      <li class='sidebar-brand'><a id="userAccess_master"  ng-click="redirectUrl($event)">Access<i class="fa fa-check-square-o sub_icon" aria-hidden="true"></i></a></li>
      <li class='sidebar-brand'><a id="billing_master"  ng-click="redirectUrl($event)">Billing<i class="fa fa-money sub_icon" aria-hidden="true"></i></a></li>
      <li class='sidebar-brand' ><a id="receipt_master"  ng-click="redirectUrl($event)">Receipt<i class="fa fa-address-book sub_icon" aria-hidden="true"></i></a></li>
	  <li class='sidebar-brand' ><a id="logout"  ng-click="redirectUrl($event)">Logout<i class="fa fa-sign-out sub_icon" aria-hidden="true"></i></a></li>
      </ul>
        
      </div>
          
      <!-- Page content -->
      <div id="page-content-wrapper">
        <div class="page-content inset">
           <div class="row">
              <div class="col-md-12">
              <div ng-view ></div>
            </div>
          </div> 
         
        </div>
      </div>
      
    </div>
<!-- <div ng-view style="width: 100%;height: 90%;"></div> -->
</div>
<script>
var app = angular.module("homeApp", ["angular.filter","ngRoute","ngResource","datatables","datatables.buttons","ngAnimate", "toastr","datatables.fixedcolumns","datatables.light-columnfilter","datatables.select"]);
app.config(['$routeProvider',function($routeProvider) {
    $routeProvider
      .when("/", {
        templateUrl: 'Login.html',
        controller: 'myCtrl'
    }) 
    .when('/Dashboard/:username', {
        templateUrl: 'Dashboard.html',
        controller: 'EmpController'
    })
     .when('/home', {
        templateUrl: 'home.html',
        controller: 'HomeController'
    })
     .when('/customer_master', {
        templateUrl: 'customer.html',
        controller: 'CustomerController'
    })
     .when('/vendor_master', {
        templateUrl: 'vendor.html',
        controller: 'VendorController'
    })
     .when('/employee_master', {
        templateUrl: 'employee.html',
        controller: 'EmployeeController'
    })
     /* .when('/product_master', {
        templateUrl: 'product.html',
        controller: 'ProductController'
    }) */
     .when('/vehicle_master', {
        templateUrl: 'vehicle.html',
        controller: 'VehicleController'
    })
    .when('/userAccess_master', {
        templateUrl: 'userAccess.html',
        controller: 'UserAccessController'
    })
    .when('/billing_master', {
        templateUrl: 'billing.html',
        controller: 'BillingController'
    })
    .when('/receipt_master', {
        templateUrl: 'receipt.html',
        controller: 'ReceiptController'
    })
     .when('/user_master', {
        templateUrl: 'user.html',
        controller: 'UserController'
    });
    /* .
    otherwise({
        redirectTo: '/Home'
    }); */
	
	
}]);

/* app.config(function ($qProvider) {
    $qProvider.errorOnUnhandledRejections(false);
}); */
app.controller('indexController',['$scope','$location', "$timeout", function ($scope, $location, $timeout) {
	$scope.user = {
	        username: '',
	        password: ''
	    }
	
	 $scope.redirectUrl= function (data){
		console.log(data);
		var menuId = data.target.id
		if(menuId == "home"){
			 $timeout( function(){
				// angular.element('#navMenu').trigger('click');
				 $location.path("/"+menuId);
				$("#title").text("Home");
				//angular.element('#menuToggle').css('z-index',"0");
		        }, 500 );
		}else if(menuId == "customer_master"){
			$timeout( function(){
				//angular.element('#navMenu').trigger('click');
				$location.path("/"+menuId);
				$("#title").text("Customer");
				//angular.element('#menuToggle').css('z-index',"0");
	        }, 500);
		}else if(menuId == "vendor_master"){
			$timeout( function(){
				//angular.element('#navMenu').trigger('click');
				$location.path("/"+menuId);
				$("#title").text("Vendor");
				//angular.element('#menuToggle').css('z-index',"0");
	        }, 500);
		}else if(menuId == "employee_master"){
			$timeout( function(){
				//angular.element('#navMenu').trigger('click');
				$location.path("/"+menuId);
				$("#title").text("Employee");
				//angular.element('#menuToggle').css('z-index',"0");
	        }, 500);
		}else if(menuId == "product_master"){
			$timeout( function(){
				//angular.element('#navMenu').trigger('click');
				$location.path("/"+menuId);
				$("#title").text("Product");
				//angular.element('#menuToggle').css('z-index',"0");
	        }, 500);
		}else if(menuId == "vehicle_master"){
			$timeout( function(){
				//angular.element('#navMenu').trigger('click');
				$location.path("/"+menuId);
				$("#title").text("Vehicle");
				//angular.element('#menuToggle').css('z-index',"0");
	        }, 500);
		}else if(menuId == "user_master"){
			$timeout( function(){
				//angular.element('#navMenu').trigger('click');
				$location.path("/"+menuId);
				$("#title").text("User");
				//angular.element('#menuToggle').css('z-index',"0");
	        }, 500);
		}else if(menuId == "userAccess_master"){
			$timeout( function(){
				//angular.element('#navMenu').trigger('click');
				$location.path("/"+menuId);
				$("#title").text("UserAccess");
				//angular.element('#menuToggle').css('z-index',"0");
	        }, 500);
		}else if(menuId == "billing_master"){
			$timeout( function(){
				//angular.element('#navMenu').trigger('click');
				$location.path("/"+menuId);
				$("#title").text("Billing");
				//angular.element('#menuToggle').css('z-index',"0");
	        }, 500);
		}else if(menuId == "receipt_master"){
			$timeout( function(){
				//angular.element('#navMenu').trigger('click');
				$location.path("/"+menuId);
				$("#title").text("Receipt"); 
				//angular.element('#menuToggle').css('z-index',"0");
	        }, 500);
			
		}
		
	} 
	//alert("dsfds")
}]);
app.controller("myCtrl", ['$scope', '$window','$location','$rootScope', function($scope, $window, $location,$rootScope){
	//$scope.loggedIn = false;    
	
	$scope.loginSubmit = function (username){
	    	/* $http.get('/checklogin').success(function(data) {
	          console.log(data);
	          if (data === true)
	            $scope.loggedIn = true;
	          else
	            $scope.loggedIn = false;
	        })
	        .error(function(data) {
	          console.log('error: ' + data);
	        }); */
	        
		 			if ($scope.user.username) {    
	                    $location.path('/Dashboard/'+ username);
	                    $rootScope.loggedIn = true;
	                }
	                else{
	                    alert('Login incorrect');
	                    $rootScope.loggedIn = false;
	            }
		}

	  
	}]);
app.controller("EmpController", ['$scope', '$routeParams' ,'$window' ,'$rootScope', function($scope, $routeParams , $window ,$rootScope ){
 

  if( $routeParams.username){
	  //$scope.loggedIn =$rootScope.loggedIn;
	  $scope.loggedIn =true;
	  $scope.username = $routeParams.username;
  }

	  
}]);
app.controller('HomeController', function ($scope) {
	console.log("alert");
});
app.controller('CustomerController',function ($scope,$http,$location,DTOptionsBuilder, DTColumnBuilder, DTColumnDefBuilder,toastr) {
	scope=$scope;
	$scope.listCustomerJson =[];
	/* $scope.listCustomerJson =[{customerId: "1111",customerName: "Demo",pan: "12354EWRWE",tan: "12354DFGDD",kyc: "123544UGDSCF",iec: "12354UUFFA",customerDetails:[{ customerAddr: "3,xyz street,mumbai", mobileNo: "123544", phoneNo: "123544",gstin: "12354RTUGF"},{ customerAddr: "3,xyz street,mumbai", mobileNo: "123544", phoneNo: "123544",gstin: "12354RTUGF"}]},
							  {customerId: "2222",customerName: "XYZ",pan: "12354EWRWE",tan: "12354DFGDD",kyc: "123544UGDSCF" ,iec: "12354UUFFA", customerDetails:[{ customerAddr: "3,xyz street,mumbai", mobileNo: "123544", phoneNo: "123544",gstin: "12354RTUGF"}]},
							  {customerId: "3333",customerName: "ABC",pan: "12354EWRWE",tan: "12354DFGDD",kyc: "123544UGDSCF" ,iec: "12354UUFFA", customerDetails:[{ customerAddr: "3,abc street,mumbai", mobileNo: "123544", phoneNo: "123544",gstin: "12354RTUGF"}]},
							  {customerId: "4444",customerName: "QWERT",pan: "12354EWRWE",tan: "12354DFGDD",kyc: "123544UGDSCF" ,iec: "12354UUFFA", customerDetails:[{ customerAddr: "3,sri street,mumbai", mobileNo: "123544", phoneNo: "123544",gstin: "12354RTUGF"}]}]; */				
	//$scope.customerDetails ={customerAddr: "",mobileNo: "",phoneNo: "",GSTIN: ""};
	
							  
	$scope.cm = {};
	$scope.cm.dtCustomer = DTOptionsBuilder.newOptions()
    .withOption('order', [0, 'asc'])
    .withButtons([
      {
        extend: 'collection',
        text: 'Export',
        buttons: [{
            extend: 'copyHtml5',
            title: 'Mylist'
          },
          {
            extend: 'pdfHtml5',
            title: 'My list'
          },
		  {
            extend: 'excel',
            title: 'Excel'
          },
		  {
            extend: 'csv',
            title: 'My list'
          }
        ]
      }
    ]);
$scope.createCust = function() {
$("#custModal").modal("show");
$(".custId").css("display","");
$(".addCust").css("display","block");
$(".updateCust").css("display","none");

$scope.item = {customername:"",tan:"",kyc:"",pan:"",iec:"",bankName:"",branch:"",accountNo:"",ifsc:"",contactPerson:"",contactNo:"",perkmtrs:"",perkmlc2:"",perkmlc4:"",perkmcan6:"",perkmhcv9:"",perkmtrailer:"",fixedamttrs:"",fixedamtlc2:"",fixedamtlc4:"",fixedamtcan6:"",fixedamthcv9:"",fixedamttrailer:""};
$scope.item.customerDetails = [{customerAddr: "",mobileNo: "",phoneNo: "",gstin: ""}];
}

$scope.addCustomerDetails = function(data){
	$scope.item.customerDetails.push({customerAddr: "",mobileNo: "",phoneNo: "",gstin: ""});

}

$scope.deleteCustomerDetails = function(index){
	$scope.item.customerDetails.splice(index,1);

}
$scope.addItem = function(item) {
	if(item.customername==""){
		 toastr.error('Please enter CustomerName');
		return;
	}else if(item.pan==""){
		 toastr.error('Please enter PAN');
		return;
	}else if(item.bankName==""){
		 toastr.error('Please enter Bank Name');
		return;
	}else if(item.branch==""){
		 toastr.error('Please enter Branch');
			return;
	}else if(item.accountNo==""){
		 toastr.error('Please enter Account Number');
			return;
	}else if(item.ifsc==""){
	 toastr.error('Please enter IFSC Code');
		return;
	}else if(item.contactPerson==""){
		 toastr.error('Please enter Contact Person');
		return;
	}else if(item.contactNo==""){
		 toastr.error('Please enter Contact Number');
			return;
	}else if(item.customerDetails[0].customerAddr==""){
		 toastr.error('Please enter Address');
			return;
	}else if(item.customerDetails[0].mobileNo==""){
		 toastr.error('Please enter Mobile No');
			return;
	}else if(item.customerDetails[0].gstin==""){
		 toastr.error('Please enter GSTIN');
			return;
	}else{
	
	var url = location.origin +"/api/v1/createcustomer";
	//$scope.listCustomerJson.push(angular.copy(item));
	    $http({
	        method : 'POST',
	        url : url,
	        data : angular.toJson($scope.item),
	        headers : {
	        'Content-Type' : 'application/json'
	        }
	        }).then(function (response) {
	            //$scope.listCustomerJson = response.data;
	            toastr.success('Data added successfully');
	        	$scope.initcust();
	        }, function error(response) {
	        	toastr.success('Data not added');
	          console.log(response.status);
	        });
	    $scope.item = {customername:"",tan:"",kyc:"",pan:"",iec:"",bankName:"",branch:"",accountNo:"",ifsc:"",contactPerson:"",contactNo:"",perkmtrs:"",perkmlc2:"",perkmlc4:"",perkmcan6:"",perkmhcv9:"",perkmtrailer:"",fixedamttrs:"",fixedamtlc2:"",fixedamtlc4:"",fixedamtcan6:"",fixedamthcv9:"",fixedamttrailer:""};
	    $scope.item.customerDetails=[{customerAddr: "",mobileNo: "",phoneNo: "",gstin: ""}];
	}
	   
}
$scope.updateItem = function(item) {
 /* for(i in $scope.listCustomerJson) {
                if($scope.listCustomerJson[i].customerId == $scope.item.customerId) {
                    $scope.listCustomerJson[i] = $scope.item;
                }
         } */
         
         
	var url = location.origin +"/api/v1/customerupdate";
	//$scope.listCustomerJson.push(angular.copy(item));
	console.log($scope.item);
	    $http({
	        method : 'PUT',
	        url : url,
	        data : angular.toJson($scope.item),
	        headers : {
	        'Content-Type' : 'application/json'
	        }
	        }).then(function (response) {
	            //$scope.listCustomerJson = response.data;
	            toastr.success('Data updated successfully');
	        	$scope.initcust();
	        }, function error(response) {
	        	toastr.success('Data not updated');
	          console.log(response.status);
	        });
         
         
}
$scope.removeItem = function(item){
//$scope.listCustomerJson.splice(index,1);
	console.log(item.id);
	var url=location.origin +"/api/v1/customer/"+item.id;
	 $http({
		    method : 'DELETE',
		    url : url,
		   }).then(function successCallback(response) {
			   toastr.success('Data deleted successfully');
			   $scope.initcust();
		   }, function errorCallback(response) {
			   toastr.success('Data not deleted');
		    console.log(response.statusText);
		   });
}
 $scope.editCustomer = function(index){
   $("#custModal").modal("show");
   $(".custId").css("display","none");
   $(".addCust").css("display","none");
   $(".updateCust").css("display","block");
for(i in $scope.listCustomerJson) {
        if($scope.listCustomerJson[i].id == index.id) {
            $scope.item = angular.copy($scope.listCustomerJson[i]);
        }
    }
 }	
 
 $scope.initcust =function(){
	 
	 var url=location.origin +"/api/v1/customerlist";
	 $http({
		    method : 'GET',
		    url : url,
		   }).then(function successCallback(response) {
		   $scope.listCustomerJson = response.data;
		   }, function errorCallback(response) {
		    console.log(response.statusText);
		   });
 }
 $scope.initcust();
});
app.controller('VendorController', function ($scope ,$http,$location,DTOptionsBuilder, DTColumnBuilder, DTColumnDefBuilder,toastr) {
	$scope.listVendorJson=[];
	 /* $scope.listVendorJson =[{vendorid: "1111",vendorName: "Demo",pan: "12354EWRWE",tan: "12354DFGDD",kyc: "123544UGDSCF",iec: "12354UUFFA",bankName:"ICICI",branch:"Chennai",accountNo:"232434",ifsc:"ICIC0003",contactPerson:"Dinesh",contactNo:"868755487",vendorVehicle:[{drivername: "Siva",mobileno: "234234",vehicleno: "555",vehicleType: "CAN3",FC: "4455",insurance: "555",RCno: "888",roadTax: "33",pollutioncert: "4324",goodPermit: "23423",statePermit: "2342"}],vendorAddress:[{ vendoraddr: "3,xyz street,mumbai", mobileno: "123544", phoneno: "123544",gstin: "12354RTUGF"},{ vendoraddr: "3,xyz street,mumbai", mobileno: "123544", phoneno: "123544",gstin: "12354RTUGF"}]},
	                        {vendorid: "2222",vendorName: "XYZ",pan: "12354EWRWE",tan: "12354DFGDD",kyc: "123544UGDSCF" ,iec: "12354UUFFA",bankName:"HDFC",branch:"Chennai",accountNo:"232434",ifsc:"ICIC0003",contactPerson:"Dinesh",contactNo:"868755487",vendorVehicle:[{drivername: "Siva",mobileno: "234234",vehicleno: "555",vehicleType: "CAN3",FC: "4455",insurance: "555",RCno: "888",roadTax: "33",pollutioncert: "4324",goodPermit: "23423",statePermit: "2342"}], vendorAddress:[{ vendoraddr: "3,xyz street,mumbai", mobileno: "123544", phoneno: "123544",gstin: "12354RTUGF"}]},
	                        {vendorid: "3333",vendorName: "ABC",pan: "12354EWRWE",tan: "12354DFGDD",kyc: "123544UGDSCF" ,iec: "12354UUFFA",bankName:"ICICI",branch:"Chennai",accountNo:"232434",ifsc:"ICIC0003",contactPerson:"Dinesh",contactNo:"868755487",vendorVehicle:[{drivername: "Siva",mobileno: "234234",vehicleno: "555",vehicleType: "CAN3",FC: "4455",insurance: "555",RCno: "888",roadTax: "33",pollutioncert: "4324",goodPermit: "23423",statePermit: "2342"}], vendorAddress:[{ vendoraddr: "3,abc street,mumbai", mobileno: "123544", phoneno: "123544",gstin: "12354RTUGF"}]},
	                        {vendorid: "4444",vendorName: "QWERT",pan: "12354EWRWE",tan: "12354DFGDD",kyc: "123544UGDSCF" ,iec: "12354UUFFA",bankName:"AXIS",branch:"Chennai",accountNo:"232434",ifsc:"ICIC0003",contactPerson:"Dinesh",contactNo:"868755487",vendorVehicle:[{drivername: "Siva",mobileno: "234234",vehicleno: "555",vehicleType: "CAN3",FC: "4455",insurance: "555",RCno: "888",roadTax: "33",pollutioncert: "4324",goodPermit: "23423",statePermit: "2342"}], vendorAddress:[{ vendoraddr: "3,sri street,mumbai", mobileno: "123544", phoneno: "123544",gstin: "12354RTUGF"}]}];	 */ 		
	
    $scope.item = {vendorname:"",tan:"",kyc:"",pan:"",iec:"",bankName:"",branch:"",accountNo:"",ifsc:"",contactPerson:"",contactNo:""};
    $scope.item.vendorAddress=[{vendoraddrid:"",vendoraddr: "",mobileno: "",phoneno: "",gstin: ""}];
    $scope.item.vendorvehicle = [{driverName: "",mobileNo: "",vehicleNo: "",vehicleType: "",fc: "",insurance: "",rCNo: "",roadTax: "",pollutioncert: "",goodPermit: "",statePermit: "",fcdate:"",insurancedate:"",fixedamt:"",perkmamt:""}];
                        
	$scope.vm = {};
	$scope.vm.dtVendor = DTOptionsBuilder.newOptions()
    .withOption('order', [0, 'asc'])
    .withButtons([
      {
        extend: 'collection',
        text: 'Export',
        buttons: [{
            extend: 'copyHtml5',
            title: 'Mylist'
          },
          {
            extend: 'pdfHtml5',
            title: 'My list'
          },
		  {
            extend: 'excel',
            title: 'Excel'
          },
		  {
            extend: 'csv',
            title: 'My list'
          }
        ]
      }
    ]);
$scope.createVendor = function() {
$("#venModal").modal('show');
$(".venId").css("display","");
$(".addVen").css("display","block");
$(".updateVen").css("display","none");
$scope.item = {vendorname:"",tan:"",kyc:"",pan:"",iec:"",bankName:"",branch:"",accountNo:"",ifsc:"",contactPerson:"",contactNo:""};
$scope.item.vendorAddress=[{vendoraddrid:"",vendoraddr: "",mobileno: "",phoneno: "",gstin: ""}];
$scope.item.vendorvehicle = [{driverName: "",mobileNo: "",vehicleNo: "",vehicleType: "",fc: "",insurance: "",rCNo: "",roadTax: "",pollutioncert: "",goodPermit: "",statePermit: "",fcdate:"",insurancedate:"",fixedamt:"",perkmamt:""}];
}

$scope.addVendorDetails = function(data){
	$scope.item.vendorAddress.push({vendoraddrid:"",vendoraddr: "",mobileno: "",phoneno: "",gstin: ""});

}
$scope.addVendorVehDetails = function(data){
	$scope.item.vendorvehicle.push({driverName: "",mobileNo: "",vehicleNo: "",vehicleType: "",fc: "",insurance: "",rCNo: "",roadTax: "",pollutioncert: "",goodPermit: "",statePermit: "",fcdate:"",insurancedate:"",fixedamt:"",perkmamt:""});

}
$scope.deleteVendorVehDetails = function(index){
	$scope.item.vendorvehicle.splice(index,1);

}
$scope.deleteVendorDetails = function(index){
	$scope.item.vendorAddress.splice(index,1);

}
$scope.addItem = function(item) {
	if(item.vendorname==""){
		 toastr.error('Please enter CustomerName');
		return;
	}else if(item.pan==""){
		 toastr.error('Please enter PAN');
		return;
	}else if(item.bankName==""){
		 toastr.error('Please enter Bank Name');
		return;
	}else if(item.branch==""){
		 toastr.error('Please enter Branch');
			return;
	}else if(item.accountNo==""){
		 toastr.error('Please enter Account Number');
			return;
	}else if(item.ifsc==""){
	 toastr.error('Please enter IFSC Code');
		return;
	}else if(item.contactPerson==""){
		 toastr.error('Please enter Contact Person');
		return;
	}else if(item.contactNo==""){
		 toastr.error('Please enter Contact Number');
			return;
	}else if(item.vendorAddress[0].customerAddr==""){
		 toastr.error('Please enter Address');
			return;
	}else if(item.vendorAddress[0].mobileno==""){
		 toastr.error('Please enter Mobile No');
			return;
	}else if(item.vendorAddress[0].gstin==""){
		 toastr.error('Please enter GSTIN');
			return;
	}else{
		//$scope.listVendorJson.push(angular.copy(item));
		var url = location.origin +"/api/v1/createvendor";
			//$scope.listCustomerJson.push(angular.copy(item));
			    $http({
			        method : 'POST',
			        url : url,
			        data : angular.toJson($scope.item),
			        headers : {
			        'Content-Type' : 'application/json'
			        }
			        }).then(function (response) {
			            //$scope.listCustomerJson = response.data;
			            toastr.success('Data added successfully');
			        	$scope.initven();
			        }, function error(response) {
			        	toastr.success('Data not added');
			          console.log(response.status);
			        });
	    $scope.item = {vendorname:"",tan:"",kyc:"",pan:"",iec:"",bankName:"",branch:"",accountNo:"",ifsc:"",contactPerson:"",contactNo:""};
		$scope.item.vendorAddress=[{vendoraddrid:"",vendoraddr: "",mobileno: "",phoneno: "",gstin: ""}];
		$scope.item.vendorvehicle = [{driverName: "",mobileNo: "",vehicleNo: "",vehicleType: "",fc: "",insurance: "",rCNo: "",roadTax: "",pollutioncert: "",goodPermit: "",statePermit: "",fcdate:"",insurancedate:"",fixedamt:"",perkmamt:""}];
	}
	
}
$scope.updateItem = function(item) {
/* for(i in $scope.listVendorJson) {
              if($scope.listVendorJson[i].vendorId == $scope.item.vendorId) {
                  $scope.listVendorJson[i] = $scope.item;
              }
       } */
	var url = location.origin +"/api/v1/vendorrupdate";
	//$scope.listCustomerJson.push(angular.copy(item));
	console.log($scope.item);
	    $http({
	        method : 'PUT',
	        url : url,
	        data : angular.toJson($scope.item),
	        headers : {
	        'Content-Type' : 'application/json'
	        }
	        }).then(function (response) {
	            //$scope.listCustomerJson = response.data;
	            toastr.success('Data updated successfully');
	        	$scope.initven();
	        }, function error(response) {
	        	toastr.success('Data not updated');
	          console.log(response.status);
	        });
}
$scope.removeItem = function(item){
//$scope.listVendorJson.splice(index,1);

	console.log(item.id);
	var url=location.origin +"/api/v1/vendor/"+item.id;
	 $http({
		    method : 'DELETE',
		    url : url,
		   }).then(function successCallback(response) {
			   toastr.success('Data deleted successfully');
			   $scope.initven();
		   }, function errorCallback(response) {
			   toastr.success('Data not deleted');
		    console.log(response.statusText);
		   });
}
$scope.editVendor = function(index){
 $("#venModal").modal('show');
 $(".venId").css("display","none");
 $(".addVen").css("display","none");
 $(".updateVen").css("display","block");
for(i in $scope.listVendorJson) {
      if($scope.listVendorJson[i].id == index.id) {
          $scope.item = angular.copy($scope.listVendorJson[i]);
      }
  }
}
	
$scope.initven =function(){
	
	 var url=location.origin +"/api/v1/vendorlist";
	 $http({
		    method : 'GET',
		    url : url,
		   }).then(function successCallback(response) {
		   $scope.listVendorJson = response.data;
		   }, function errorCallback(response) {
		    console.log(response.statusText);
		   });
}


$scope.initven();

});
app.controller('EmployeeController', function ($scope ,$http,$location,DTOptionsBuilder, DTColumnBuilder, DTColumnDefBuilder,toastr) {
	 $scope.listEmployeeJson =[];
	/* $scope.listEmployeeJson =[{empid: "1111",empname: "Demo", role: "Supervisor", designation: "GradeA",mobileNo:"34534545",address:"ABC nagar",PAN:"3fsdf4sd",DOB:"22/7/1991",fatherName:"xzsd",salaryPackage:"8000"},
							  {empId: "2222",empName: "XYZ", empRole: "Employee", designation: "GradeB",mobileNo:"34534545",address:"ABC nagar",PAN:"3fsdf4sd",DOB:"22/7/1991",fatherName:"xzsd",salaryPackage:"8000"},
							  {empId: "3333",empName: "ABC", empRole: "Manager", designation: "GradeC",mobileNo:"34534545",address:"ABC nagar",PAN:"3fsdf4sd",DOB:"22/7/1991",fatherName:"xzsd",salaryPackage:"8000"},
							  {empId: "4444",empName: "QWERT", empRole: "Sales Executive", designation: "GradeD",mobileNo:"34534545",address:"ABC nagar",PAN:"3fsdf4sd",DOB:"22/7/1991",fatherName:"xzsd",salaryPackage:"8000"}];	 */			
	$scope.em = {};
	$scope.em.dtOptions = DTOptionsBuilder.newOptions()
    .withOption('order', [0, 'asc'])
    .withButtons([
      {
        extend: 'collection',
        text: 'Export',
        buttons: [{
            extend: 'copyHtml5',
            title: 'Mylist'
          },
          {
            extend: 'pdfHtml5',
            title: 'My list'
          },
		  {
            extend: 'excel',
            title: 'Excel'
          },
		  {
            extend: 'csv',
            title: 'My list'
          }
        ]
      }
    ]);
$scope.createEmp = function() {
$("#empModal").modal('show');
$(".empId").css("display","");
$(".addEmp").css("display","block");
$(".updateEmp").css("display","none");
$scope.item = {};
}
$scope.addItem = function(item) {
	
	var url = location.origin +"/api/v1/employees";
	//$scope.listCustomerJson.push(angular.copy(item));
	    $http({
	        method : 'POST',
	        url : url,
	        data : angular.toJson($scope.item),
	        headers : {
	        'Content-Type' : 'application/json'
	        }
	        }).then(function (response) {
	            //$scope.listCustomerJson = response.data;
	            toastr.success('Data added successfully');
	        	$scope.init();
	        }, function error(response) {
	        	toastr.success('Data not added');
	          console.log(response.status);
	        });
$scope.listEmployeeJson.push(item);
$scope.item = {};

}
$scope.updateItem = function(item) {
 /* for(i in $scope.listEmployeeJson) {
                if($scope.listEmployeeJson[i].empid == $scope.item.empid) {
                    $scope.listEmployeeJson[i] = $scope.item;
                }
         } */
         
	var url = location.origin +"/api/v1/employeeupdate";
	//$scope.listCustomerJson.push(angular.copy(item));
	console.log($scope.item);
	    $http({
	        method : 'PUT',
	        url : url,
	        data : angular.toJson($scope.item),
	        headers : {
	        'Content-Type' : 'application/json'
	        }
	        }).then(function (response) {
	            //$scope.listCustomerJson = response.data;
	            toastr.success('Data updated successfully');
	        	$scope.init();
	        }, function error(response) {
	        	toastr.success('Data not updated');
	          console.log(response.status);
	        });
}
$scope.removeItem = function(item){
//$scope.listEmployeeJson.splice(index,1);
	console.log(item.id);
	var url=location.origin +"/api/v1/employee/"+item.id;
	 $http({
		    method : 'DELETE',
		    url : url,
		   }).then(function successCallback(response) {
			   toastr.success('Data deleted successfully');
			   $scope.init();
		   }, function errorCallback(response) {
			   toastr.success('Data not deleted');
		    console.log(response.statusText);
		   });
}
 $scope.editEmp = function(index){
 
   $("#empModal").modal('show');
   $(".empId").css("display","none");
   $(".addEmp").css("display","none");
   $(".updateEmp").css("display","block");
for(i in $scope.listEmployeeJson) {
        if($scope.listEmployeeJson[i].empid == index.empid) {
            $scope.item = angular.copy($scope.listEmployeeJson[i]);
        }
    }
 }	
 $scope.init =function(){
	 $('#datetimepicker4').datetimepicker({
	        format: 'DD/MM/YYYY'
	    });
	 
	 
	 var url=location.origin +"/api/v1/employeelist";
	 $http({
		    method : 'GET',
		    url : url,
		   }).then(function successCallback(response) {
		   $scope.listEmployeeJson = response.data;
		   }, function errorCallback(response) {
		    console.log(response.statusText);
		   });
 }
 $scope.init();
});
app.controller('ProductController', function ($scope ,$http,$location,DTOptionsBuilder, DTColumnBuilder, DTColumnDefBuilder,toastr) {
	$scope.listProductJson=[];
	/* $scope.listProductJson =[{productCode:"1111",productId: "1111",productName: "WashingMachine", HSNSAC: "4566", TaxType: "0%"},
							  {productCode:"2222",productId: "1223",productName: "Cooler", HSNSAC: "3456", TaxType: "12%"},
							  {productCode:"3333",productId: "3456",productName: "Fan", HSNSAC: "2345", TaxType: "5%"},
							  {productCode:"4444",productId: "5643",productName: "Furniture", HSNSAC: "1234", TaxType: "18%"}];	 */			
	$scope.pm = {};
	$scope.pm.dtProduct = DTOptionsBuilder.newOptions()
    .withOption('order', [0, 'asc'])
    .withButtons([
      {
        extend: 'collection',
        text: 'Export',
        buttons: [{
            extend: 'copyHtml5',
            title: 'Mylist'
          },
          {
            extend: 'pdfHtml5',
            title: 'My list'
          },
		  {
            extend: 'excel',
            title: 'Excel'
          },
		  {
            extend: 'csv',
            title: 'My list'
          }
        ]
      }
    ]);
$scope.createProduct = function() {
$("#prodModal").modal('show');
$(".prodId").css("display","");
$(".addProd").css("display","block");
$(".updateProd").css("display","none");
$scope.item = {};
}
$scope.addItem = function(item) {
	var url = location.origin +"/api/v1/createproduct";
	//$scope.listCustomerJson.push(angular.copy(item));
	    $http({
	        method : 'POST',
	        url : url,
	        data : angular.toJson($scope.item),
	        headers : {
	        'Content-Type' : 'application/json'
	        }
	        }).then(function (response) {
	            //$scope.listCustomerJson = response.data;
	            toastr.success('Data added successfully');
	        	$scope.initProduct();
	        }, function error(response) {
	        	toastr.success('Data not added');
	          console.log(response.status);
	        });
//$scope.listProductJson.push(item);
$scope.item = {};

}
$scope.updateItem = function(item) {
/* for(i in $scope.listProductJson) {
               if($scope.listProductJson[i].productCode == $scope.item.productCode) {
                   $scope.listProductJson[i] = $scope.item;
               }
        } */
        
	var url = location.origin +"/api/v1/productupdate";
	//$scope.listCustomerJson.push(angular.copy(item));
	console.log($scope.item);
	    $http({
	        method : 'PUT',
	        url : url,
	        data : angular.toJson($scope.item),
	        headers : {
	        'Content-Type' : 'application/json'
	        }
	        }).then(function (response) {
	            //$scope.listCustomerJson = response.data;
	            toastr.success('Data updated successfully');
	        	$scope.initProduct();
	        }, function error(response) {
	        	toastr.success('Data not updated');
	          console.log(response.status);
	        });
}
$scope.removeItem = function(item){
//$scope.listProductJson.splice(index,1);
	console.log(item.id);
	var url=location.origin +"/api/v1/product/"+item.id;
	 $http({
		    method : 'DELETE',
		    url : url,
		   }).then(function successCallback(response) {
			   toastr.success('Data deleted successfully');
			   $scope.initProduct();
		   }, function errorCallback(response) {
			   toastr.success('Data not deleted');
		    console.log(response.statusText);
		   });
}
$scope.editProduct = function(index){

  $("#prodModal").modal('show');
  $(".prodId").css("display","none");
  $(".addProd").css("display","none");
  $(".updateProd").css("display","block");
for(i in $scope.listProductJson) {
       if($scope.listProductJson[i].productcode == index.productcode) {
           $scope.item = angular.copy($scope.listProductJson[i]);
       }
   }
}	
$scope.initProduct = function(){
	 var url=location.origin +"/api/v1/productlist";
	 $http({
		    method : 'GET',
		    url : url,
		   }).then(function successCallback(response) {
		   $scope.listProductJson = response.data;
		   }, function errorCallback(response) {
		    console.log(response.statusText);
		   });
}
$scope.initProduct();
});
app.controller('VehicleController', function ($scope, $window ,$filter,$http,$location,DTOptionsBuilder, DTColumnBuilder, DTColumnDefBuilder,toastr,multipartForm) {
	$scope.listVehicleJson ={};
	 //$scope.listCustJson=[];
	 //$scope.listVenJson=[];
	 $scope.listdataJson=[];
	 $scope.getTruckType=[];
	 $scope.tempperkmchargevendor="0";
	 $scope.tempfreightAmtCust="0";
	 $scope.tempfreightAmtVen="0";
	 $scope.getTempCustVen={};
	 //$scope.vehlistdataJson=[];
	/* $scope.listVehicleJson =[{codeId: "1111",truckNo: "3455", rcno: "4566", fcDate: "23/4/2019", truckType: "Transport truck"},
							  {codeId: "1223",truckNo: "56767", rcno: "3456", fcDate: "23/4/2019", truckType: "Dump truck"},
							  {codeId: "3456",truckNo: "5675", rcno: "2345", fcDate: "23/4/2019", truckType: "Garbage truck"},
							  {codeId: "5643",truckNo: "56756", rcno: "1234", fcDate: "23/4/2019", truckType: "Box truck"}]; */				
	/*$scope.trip = [{loadNo: "1111",tripNo: "2222",origin: "NEEMAM",destination: "EGMORE",invoiceNO: "234322",dateTime: "23/4/2019",truckType: "CAN2",truckNo: "TN2323200",driverName: "Siva",noOfCase: "3",OPKM: "2",CLSKM: "5",diffKM: "4",advance: "500",perKMchargeCustomer: "6.5",perKMchargeVendor: "7.6",profit: "400",tollBill: "654787",policeBill: "57890",freightAmt: "700",haltingCharge: "700",remarks: "good"},
					{loadNo: "1111",tripNo: "2222",origin: "NEEMAM",destination: "EGMORE",invoiceNO: "234322",dateTime: "23/4/2019",truckType: "CAN2",truckNo: "TN2323200",driverName: "Siva",noOfCase: "3",OPKM: "2",CLSKM: "5",diffKM: "4",advance: "500",perKMchargeCustomer: "6.5",perKMchargeVendor: "7.6",profit: "400",tollBill: "654787",policeBill: "57890",freightAmt: "700",haltingCharge: "700",remarks: "good"}];
							  
	*/	
	$scope.trip = {loadNo: "",tripNo: "",origin: "",destination: "",invoiceNO: "",dateTime: "",truckType: "",truckno: "",driverName: "",noOfCase: "",opkm: "0",clskm: "0",diffKM: "0",advance: "0",perkmchargecustomer: "0",perkmchargevendor: "0",profit: "0",tollBill: "",policeBill: "",freightAmtCust: "0",freightAmtVen:"0",haltingCharge: "0",discount:"0",remarks: ""};
	scope=$scope;
	$scope.vehm = {};
	$scope.vehm.dtVehicle = DTOptionsBuilder.newOptions()
    .withOption('order', [0, 'asc'])
    .withButtons([
      {
        extend: 'collection',
        text: 'Export',
        buttons: [{
            extend: 'copyHtml5',
            title: 'Mylist'
          },
          {
            extend: 'pdfHtml5',
            title: 'My list'
          },
		  {
            extend: 'excel',
            title: 'Excel'
          },
		  {
            extend: 'csv',
            title: 'My list'
          }
        ]
      }
    ]);
	
	$scope.validateOrigin =function(data){
		if($scope.listdataJson.indexOf(data) == -1) {
			 toastr.error('Invalid Data');
			}
	}
	
	$scope.getCommonDetails =function(item){
		
		if(item){
		var url=location.origin +"/api/v1/customervendorobject";
		 $http({
			    method : 'GET',
			    url : url,
			    params: {name: item}
			   }).then(function successCallback(response) {
			   console.log(response);
			   var respData=response.data[0];
			   if(respData.customername){
				   $scope.getTempCustVen =respData;
				   $scope.trip.truckno="";
			   }
			   
			   /* if(respData.customername){
				   if($scope.trip.truckType=="LCV2"){
					   $scope.trip.perkmchargecustomer=respData.perkmlc2;
					   $scope.trip.freightAmtCust=respData.fixedamtlc2;
				   }else if($scope.trip.truckType=="LCV4"){
					   $scope.trip.perkmchargecustomer=respData.perkmlc4;
						$scope.trip.freightAmtCust=respData.fixedamtlc2;
				   }else if($scope.trip.truckType=="CAN6"){
					   $scope.trip.perkmchargecustomer=respData.perkmcan6;
						$scope.trip.freightAmtCust=respData.fixedamtcan6;
				   }else if($scope.trip.truckType=="HCV9"){
					   $scope.trip.perkmchargecustomer=respData.perkmhcv9;
						$scope.trip.freightAmtCust=respData.fixedamthcv9;
				   }else if($scope.trip.truckType=="TARUS"){
					   $scope.trip.perkmchargecustomer=respData.perkmtrs;
						$scope.trip.freightAmtCust=respData.fixedamttrs;
				   }else if($scope.trip.truckType=="TRALIER"){
					   $scope.trip.perkmchargecustomer=respData.perkmtrailer;
					   $scope.trip.freightAmtCust=respData.fixedamttrailer;
				   }
			   } */
			   }, function errorCallback(response) {
			    console.log(response.statusText);
			   });
		}
	}
	$scope.changeBasedNumber =function(item){
		 $scope.tempperkmchargecustomer="";
		$scope.tempperkmchargevendor="";
		$scope.tempfreightAmtCust="";
		$scope.tempfreightAmtVen="";
		//$scope.trip.perkmchargevendor="";
		 angular.forEach($scope.vehlistdataJson,function(value,index){
			 if(value.vehicleNo ==item){
				 $scope.trip.truckType=value.vehicleType;
				 //$scope.trip.perkmchargevendor=value.perkmamt;
				 $scope.tempperkmchargevendor=value.perkmamt;
				 $scope.tempfreightAmtVen=value.fixedamt;
				// $scope.trip.freightAmtVen=value.fixedamt;
				 $scope.trip.opkm="";
				 $scope.trip.clskm="";
				 $scope.trip.diffKM="";
				 $scope.trip.perkmchargevendor="";
				 $scope.trip.perkmchargecustomer="";
				 $scope.trip.tollBill="";
				 $scope.trip.policeBill="";
				 
				 
				 //set customer perkm and fixed
				 var tempcustVen =$scope.getTempCustVen;
				 if($scope.getTempCustVen.customername){
					   if($scope.trip.truckType=="LCV2"){
						   //$scope.trip.perkmchargecustomer=tempcustVen.perkmlc2;
						   //$scope.trip.freightAmtCust=tempcustVen.fixedamtlc2;
						   $scope.tempfreightAmtCust=tempcustVen.fixedamtlc2;
						   $scope.tempperkmchargecustomer=tempcustVen.perkmlc2;
					   }else if($scope.trip.truckType=="LCV4"){
						  // $scope.trip.perkmchargecustomer=tempcustVen.perkmlc4;
						   $scope.tempperkmchargecustomer=tempcustVen.perkmlc4;
						   $scope.tempfreightAmtCust=tempcustVen.fixedamtlc4;
							
					   }else if($scope.trip.truckType=="CAN6"){
						   //$scope.trip.perkmchargecustomer=tempcustVen.perkmcan6;
						   $scope.tempperkmchargecustomer=tempcustVen.perkmcan6;
						   $scope.tempfreightAmtCust=tempcustVen.fixedamtcan6;
					   }else if($scope.trip.truckType=="HCV9"){
						  // $scope.trip.perkmchargecustomer=tempcustVen.perkmhcv9;
						   $scope.tempperkmchargecustomer=tempcustVen.perkmhcv9;
						   $scope.tempfreightAmtCust=tempcustVen.fixedamthcv9;
					   }else if($scope.trip.truckType=="TARUS"){
						  // $scope.trip.perkmchargecustomer=tempcustVen.perkmtrs;
						   $scope.tempperkmchargecustomer=tempcustVen.perkmtrs;
						   $scope.tempfreightAmtCust=tempcustVen.fixedamttrs;
					   }else if($scope.trip.truckType=="TRALIER"){
						   //$scope.trip.perkmchargecustomer=tempcustVen.perkmtrailer;
						   $scope.tempperkmchargecustomer=tempcustVen.perkmtrailer;
						   $scope.tempfreightAmtCust=tempcustVen.fixedamttrailer;
					   }
				   }	 
			 }
			 
         })
		
		
	}
	
	/* $scope.haltingCharge =function(){
		
		$scope.trip.freightAmtCust=eval($scope.trip.haltingCharge)+eval($scope.trip.freightAmtCust);
		
	} */
	$scope.calculateKm=function(opkm,clskm){
		if(opkm){
			if(eval(opkm)<eval(clskm)){
				$scope.trip.diffKM=(parseInt(clskm)? parseInt(clskm):0)-(parseInt(opkm)? parseInt(opkm):0);
				$scope.trip.perkmchargevendor=(parseInt($scope.trip.diffKM)? parseInt($scope.trip.diffKM):0) * (parseInt($scope.tempperkmchargevendor)? parseInt($scope.tempperkmchargevendor):0);
				$scope.trip.perkmchargecustomer=(parseInt($scope.trip.diffKM)? parseInt($scope.trip.diffKM):0) * (parseInt($scope.tempperkmchargecustomer)? parseInt($scope.tempperkmchargecustomer):0);
			}else{
				toastr.error('Close Kms should lesser than Open Kms');
				$scope.trip.diffKM="";
			}
		}else{
			toastr.error('Please Enter OpKms');
		}
		
	}
	
	$scope.addAmtoFrieght =function(){
		
		if(typeof($scope.trip.freightAmtCust)=="undefined"){
			$scope.trip.freightAmtCust='0';
		}
		if(typeof($scope.trip.freightAmtVen)=="undefined" || typeof($scope.trip.freightAmtVen)=="number" ){
			$scope.trip.freightAmtVen='0';
		}
		if(typeof($scope.trip.policeBill)=="undefined"){
			$scope.trip.policeBill='0';
		}
		if(typeof($scope.trip.tollBill)=="undefined"){
			$scope.trip.tollBill='0';
		}
		if(typeof($scope.trip.haltingCharge)=="undefined"){
			$scope.trip.haltingCharge='0';
		}
		$scope.trip.freightAmtCust=eval($scope.trip.policeBill)+eval($scope.trip.tollBill)+eval($scope.tempfreightAmtCust)+eval($scope.trip.haltingCharge)+eval($scope.trip.perkmchargecustomer);
		$scope.trip.freightAmtVen=eval($scope.trip.tollBill)+eval($scope.trip.policeBill)+eval($scope.tempfreightAmtVen)+eval($scope.trip.perkmchargevendor);
		
		$scope.trip.profit=(parseInt($scope.trip.freightAmtCust)? parseInt($scope.trip.freightAmtCust):0) - (parseInt($scope.trip.freightAmtVen)? parseInt($scope.trip.freightAmtVen):0);
	}
	
/* $scope.addAmtoFrieghtVen =function(data){
		
		if(typeof($scope.trip.freightAmtCust)=="undefined"){
			$scope.trip.freightAmtCust='0';
		}
		if(typeof($scope.trip.freightAmtVen)=="undefined" || typeof($scope.trip.freightAmtVen)=="number" ){
			$scope.trip.freightAmtVen='0';
		}
		if(typeof($scope.trip.tollBill)=="undefined"){
			$scope.trip.tollBill='0';
		}
		$scope.trip.freightAmtVen=eval($scope.trip.tollBill)+eval(data)+eval($scope.tempfreightAmtVen);
		//$scope.trip.freightAmtVen=eval($scope.trip.freightAmtVen)+eval(data);
	} */
$scope.createVehicle = function() {
$("#vehModal").modal('show');
$(".vehId").css("display","");
$(".addVeh").css("display","block");
$(".updateVeh").css("display","none");

}
$scope.createTrip = function() {
$('#tripModal').modal('show');
$(".addVeh").css("display","block");
$(".updateVeh").css("display","none");
$scope.trip={};
}
$scope.addItem = function(item) {
	
	if(item.loadno==""){
		 toastr.error('Please enter Load Number');
		return;
	}else if(item.tripNo==""){
		 toastr.error('Please enter Trip Number');
		return;
	}
	else if(item.origin==""){
		 toastr.error('Please enter Origin');
		return;
	}else if(item.destination==""){
		 toastr.error('Please enter Destination');
			return;
	}else if(item.invoiceNo==""){
		 toastr.error('Please enter Invoice Number');
			return;
	}else if(item.datetime==""){
		 toastr.error('Please enter Date');
			return;
	}else if(item.truckno==""){
		 toastr.error('Please enter Truck Number');
			return;
	}else if(item.truckType==""){
		 toastr.error('Please enter Truck Type');
			return;
	}else if(item.driverName==""){
		 toastr.error('Please enter Driver Name');
			return;
	}else if(item.noOfCase==""){
		 toastr.error('Please enter No Of Case');
			return;
	}else if(item.opkm==""){
		 toastr.error('Please enter opKm');
			return;
	}else if(item.clskm==""){
		 toastr.error('Please enter Clskm');
			return;
	}else if(item.advance==""){
		 toastr.error('Please enter Advance');
			return;
	}else if(item.tollBill==""){
		 toastr.error('Please enter Toll Bill');
			return;
	}else if(item.policeBill==""){
		 toastr.error('Please enter Police Bill');
			return;
	}else if(item.haltingCharge==""){
		 toastr.error('Please enter Halting Charge');
			return;
	}else if(item.discount==""){
		 toastr.error('Please enter Discount');
			return;
	}
	else{
//$scope.listVehicleJson.push(item);
var url = location.origin +"/api/v1/createtripsheet";
	//$scope.listCustomerJson.push(angular.copy(item));
	    $http({
	        method : 'POST',
	        url : url,
	        data : angular.toJson(item),
	        headers : {
	        'Content-Type' : 'application/json'
	        }
	        }).then(function (response) {
	            //$scope.listCustomerJson = response.data;
	            toastr.success('Data added successfully');
	        	$scope.initVeh();
	        }, function error(response) {
	        	toastr.success('Data not added');
	          console.log(response.status);
	        });
$scope.trip = {};
	}
}

$scope.closeUpload =function(){
	$("#uploadDiv").css("display","none");
};
$scope.openUpload =function(){
	$("#uploadDiv").css("display","block");
};
$scope.submitFileUpload =function(){
	var uploadUrl = '/api/v1/upload';
    multipartForm.post(uploadUrl, $scope.file);
};
$scope.submitUpload =function(){
	console.log("submit");
	 var fd = new FormData()
     for (var i in $scope.files) {
         fd.append("uploadedFile", $scope.files[i]);
     }
     var xhr = new XMLHttpRequest()
     xhr.upload.addEventListener("progress", $scope.uploadProgress, false)
     xhr.addEventListener("load", $scope.uploadComplete, false)
     xhr.addEventListener("error", $scope.uploadFailed, false)
     xhr.addEventListener("abort", $scope.uploadCanceled, false)
     xhr.open("POST", "/fileupload")
     //scope.progressVisible = true
     xhr.send(fd)
};


$scope.uploadProgress =function(evt) {
    
}

$scope.uploadComplete = function(evt) {
    /* This event is raised when the server send back a response */
    alert(evt.target.responseText);
}

$scope.uploadFailed = function(evt) {
    alert("There was an error attempting to upload the file.");
}

$scope.uploadCanceled = function(evt) {
    alert("The upload has been canceled by the user or the browser dropped the connection.");
}

$scope.setFiles = function(element) {
    $scope.$apply(function(scope) {
      console.log('files:', element.files);
      // Turn the FileList object into an Array
        $scope.files = []
        for (var i = 0; i < element.files.length; i++) {
          $scope.files.push(element.files[i])
        }
    // scope.progressVisible = false
      });
    };

$scope.updateItem = function(item) {
/* for(i in $scope.listVehicleJson) {
               if($scope.listVehicleJson[i].codeId == $scope.item.codeId) {
                   $scope.listVehicleJson[i] = $scope.item;
               }
        } */
	var url = location.origin +"/api/v1/updatetripsheet";
	//$scope.listCustomerJson.push(angular.copy(item));
	console.log($scope.item);
	    $http({
	        method : 'PUT',
	        url : url,
	        data : angular.toJson($scope.trip),
	        headers : {
	        'Content-Type' : 'application/json'
	        }
	        }).then(function (response) {
	            //$scope.listCustomerJson = response.data;
	            toastr.success('Data updated successfully');
	        	$scope.initVeh();
	        }, function error(response) {
	        	toastr.success('Data not updated');
	          console.log(response.status);
	        });
}
$scope.removeItem = function(item){
//$scope.listVehicleJson.splice(index,1);
	var url=location.origin +"/api/v1/tripsheet/"+item.tripid;
	 $http({
		    method : 'DELETE',
		    url : url,
		   }).then(function successCallback(response) {
			   toastr.success('Data deleted successfully');
			   $scope.initVeh();
		   }, function errorCallback(response) {
			   toastr.success('Data not deleted');
		    console.log(response.statusText);
		   });
}
$scope.editVehicle = function(index){
	$('#tripModal').modal('show');
  //$("#vehModal").modal('show');
  $(".vehId").css("display","none");
  $(".addVeh").css("display","none");
  $(".updateVeh").css("display","block");
for(i in $scope.listVehicleJson) {
       if($scope.listVehicleJson[i].truckno == index.truckno) {
           $scope.trip = angular.copy($scope.listVehicleJson[i]);
       }
   }
}
$scope.newtabTrip =function(){
	 var w = $window.open();
	  var html = $(".tripItems").html();
	  $(w.document.head).append("<link rel='stylesheet' href='https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css'>");
	  var scriptjquery = document.createElement( 'script' );
	  scriptjquery.type = 'text/javascript';
	  scriptjquery.src = 'https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js';
	  $(w.document.head).append( scriptjquery );
	  var scriptbootstrap = document.createElement( 'script' );
	  scriptbootstrap.type = 'text/javascript';
	  scriptbootstrap.src = 'https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js';
	  $(w.document.head).append( scriptbootstrap );
	  $(w.document.body).html(html);
	setTimeout(function(){ 
	    w.print();
	}, 500);
}
$scope.initVeh =function(){
	 $('#datetimepicker5').datetimepicker(/* {
	        format: 'DD/MM/YYYY'
	    } */);
	 var url=location.origin +"/api/v1/triplist";
	 $http({
		    method : 'GET',
		    url : url,
		   }).then(function successCallback(response) {
		   $scope.listVehicleJson = response.data;
		   }, function errorCallback(response) {
		    console.log(response.statusText);
		   });
}
$scope.getCustVenList =function(){
	 var url=location.origin +"/api/v1/combinenameslist";
	 $http({
		    method : 'GET',
		    url : url,
		   }).then(function successCallback(response) {
		   //$scope.listCustJson = response.data;
		   $scope.listdataJson=response.data;
		   }, function errorCallback(response) {
		    console.log(response.statusText);
		   });
}
$scope.getTruckList =function(){
	 var url=location.origin +"/api/v1/vehiclelist";
	 $http({
		    method : 'GET',
		    url : url,
		   }).then(function successCallback(response) {
		   //$scope.listCustJson = response.data;
		    $scope.vehlistdataJson = []; 
           /*  var values = [ 
            {name: 'Binary Search'}, 
            {name: 'Linear Search'}, 
            {name: 'Interpolation Search'} 
            ];   
            angular.forEach(values, function (value, key) { 
                $scope.names.push(value.name); 
            }); */ 
		   $scope.vehlistdataJson=response.data;
		   }, function errorCallback(response) {
		    console.log(response.statusText);
		   });
}
$scope.getTruckNo = function(selectedType) {

    // get the selected bank object from the banks array
    var filteredBank = $filter('filter')($scope.vehlistdataJson, selectedType);
    $scope.getTruckType.push(filteredBank[0].vehicleNo);
    // return the branches of the selected bank
    //return filteredBank[0].vehicleNo;
    
};
$scope.initVeh();
$scope.getCustVenList();
$scope.getTruckList();
	
$scope.bay=function() {
	var xmlhttp;
	if (window.XMLHttpRequest) {// code for IE7+, Firefox, Chrome, Opera, Safari
		xmlhttp = new XMLHttpRequest();
		var myWindow = $window.open('', '', 'width=2000,height=1000');
		  $(myWindow.document.head).append("<link rel='stylesheet' href='https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css'>");
		  var scriptjquery = document.createElement( 'script' );
		  scriptjquery.type = 'text/javascript';
		  scriptjquery.src = 'https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js';
		  $(myWindow.document.head).append( scriptjquery );
		  var scriptbootstrap = document.createElement( 'script' );
		  scriptbootstrap.type = 'text/javascript';
		  scriptbootstrap.src = 'https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js';
		  $(myWindow.document.head).append( scriptbootstrap );
		  
		myWindow.document.write("<body style='font: bold; font-size: xxx-small; line-height: 0.5cm;'><img src=\"img/sse.png height='42px' width='42px'\"><h1 align='center'>SSE LOGISTICS PRIVATE LIMITED</h1> ");
						//+ "<h4  align='center'>484, Pantheon Plaza, Pantheon Road, Egmore, Chennai - 600 008. INDIA</h4>"
						//+ "<h4  align='center'>Ph:+91-44-1111 4444, 2222 3333  FAX:+91-44-5559-5555</h4>");
		
		//$(myWindow.document.body).append("<div class='container'><div class='row'><div class='col-xs-5'><div class='panel panel-default'><div class='panel-heading'><h3 class='panel-title'>Company Details</h3></div><div class='panel-body'><dl class='dl-horizontal'><dt>Name</dt><dd><strong>Acme Corporation</strong></dd><dt>Industry</dt><dd>Software Development</dd><dt>Address</dt><dd>Field 3, Moon</dd><dt>Phone</dt><dd>123.4456.4567</dd><dt>Email</dt><dd>mainl@acme.com</dd><dt>Tax NO</dt><dd class='mono'>123456789</dd><dt>Tax Office</dt><dd>A' Moon</dd></div></div></div><div class='col-xs-7'><div class='panel panel-default'><div class='panel-heading'><h3 class='panel-title'>Customer Details</h3></div><div class='panel-body'><dl class='dl-horizontal'><dt>Name</dt><dd>Microsoft Corporation</dd><dt>Industry</dt><dd>Software Development</dd><dt>Address</dt><dd>One Microsoft Way Redmond, WA 98052-7329, USA</dd><dt>Phone</dt><dd>(425) 882-8080</dd><dt>Email</dt><dd>contact@microsoft.com</dd><dt>Tax NO</dt><dd class='mono'>123456789</dd><dt>&nbsp;</dt><dd>&nbsp;</dd></div></div></div></div></div>");
		$(myWindow.document.body).append("<table border='1'; cellpadding=0.1; cellspacing=5; align='center' >"
						+ "<tr><td><b>FROM</b></td><td><b>TO</b></td>"
						+ "<td>DATE</td><td>VEHICLETYPE</td><td>VEHICLENO </td><td>DRIVERNAME</td>" + "</tr><tr><td><b> " +  $scope.trip.from
						+ "   </b></td><td><b>" + $scope.trip.to + "</b></td>" + "<td>" + $scope.trip.date
						+ "</td><td>" + $scope.trip.vehicleType + "</td><td>" + $scope.trip.vehicleNo + " </td><td>"+$scope.trip.driverName+"</td>"
						+ "</tr></table>");
		$(myWindow.document.body).append("");
		
		$(myWindow.document).close();
		$(myWindow).focus();
		$(myWindow).print();
		$(myWindow).close();
	} else {// code for IE6, IE5
		xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
	}
	xmlhttp.onreadystatechange = function() {
		if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
			document.getElementById("myDiv").innerHTML = xmlhttp.responseText;
		}
	}
	
	xmlhttp.send();
}
});
app.controller('UserController', function ($scope,$http,$location,DTOptionsBuilder, DTColumnBuilder, DTColumnDefBuilder,toastr) {
	$scope.listUserJson=[];
	/* $scope.listUserJson =[{codeId: "1111",userId: "1111",userName: "Demo", email: "Supervisor@gamil.com", password: "GradeA", retypepassword: "GradeA", userRole: "Supervisor"},
						  {codeId: "2222",userId: "2222",userName: "XYZ", email: "Employee@gmail.com", password: "GradeB", retypepassword: "GradeA", userRole: "Employee"},
						  {codeId: "3333",userId: "3333",userName: "ABC", email: "Manager@gmail.com", password: "GradeC", retypepassword: "GradeA", userRole: "Manager"},
						  {codeId: "4444",userId: "4444",userName: "QWERT", email: "SalesExecutive@gmail.com", password: "GradeD", retypepassword: "GradeA", userRole: "SalesExecutive"}]; */				
	$scope.um = {};
	$scope.um.dtUser = DTOptionsBuilder.newOptions()
    .withOption('order', [0, 'asc'])
    .withButtons([
      {
        extend: 'collection',
        text: 'Export',
        buttons: [{
            extend: 'copyHtml5',
            title: 'Mylist'
          },
          {
            extend: 'pdfHtml5',
            title: 'My list'
          },
		  {
            extend: 'excel',
            title: 'Excel'
          },
		  {
            extend: 'csv',
            title: 'My list'
          }
        ]
      }
    ]);
$scope.createUser = function() {
$("#usrModal").modal('show');
$(".usrId").css("display","");
$(".addUsr").css("display","block");
$(".updateUsr").css("display","none");
$scope.item = {};
}
$scope.addItem = function(item) {
//$scope.listUserJson.push(item);
var url = location.origin +"/api/v1/createuser";
	//$scope.listCustomerJson.push(angular.copy(item));
	    $http({
	        method : 'POST',
	        url : url,
	        data : angular.toJson($scope.item),
	        headers : {
	        'Content-Type' : 'application/json'
	        }
	        }).then(function (response) {
	            //$scope.listCustomerJson = response.data;
	            toastr.success('Data added successfully');
	        	$scope.initUser();
	        }, function error(response) {
	        	toastr.success('Data not added');
	          console.log(response.status);
	        });
$scope.item = {};

}
$scope.updateItem = function(item) {
/* for(i in $scope.listUserJson) {
            if($scope.listUserJson[i].codeId == $scope.item.codeId) {
                $scope.listUserJson[i] = $scope.item;
            }
     } */
	var url = location.origin +"/api/v1/userupdate";
	//$scope.listCustomerJson.push(angular.copy(item));
	console.log($scope.item);
	    $http({
	        method : 'PUT',
	        url : url,
	        data : angular.toJson($scope.item),
	        headers : {
	        'Content-Type' : 'application/json'
	        }
	        }).then(function (response) {
	            //$scope.listCustomerJson = response.data;
	            toastr.success('Data updated successfully');
	        	$scope.initUser();
	        }, function error(response) {
	        	toastr.success('Data not updated');
	          console.log(response.status);
	        });
}
$scope.removeItem = function(item){
//$scope.listUserJson.splice(index,1);
	var url=location.origin +"/api/v1/user/"+item.id;
	 $http({
		    method : 'DELETE',
		    url : url,
		   }).then(function successCallback(response) {
			   toastr.success('Data deleted successfully');
			   $scope.initUser();
		   }, function errorCallback(response) {
			   toastr.success('Data not deleted');
		    console.log(response.statusText);
		   });
}
$scope.editCustomer = function(index){

$("#usrModal").modal('show');
$(".usrId").css("display","none");
$(".addUsr").css("display","none");
$(".updateUsr").css("display","block");
for(i in $scope.listUserJson) {
    if($scope.listUserJson[i].codeId == index.codeId) {
        $scope.item = angular.copy($scope.listUserJson[i]);
    }
}
}
$scope.initUser =function(){
	
	 var url=location.origin +"/api/v1/userlist";
	 $http({
		    method : 'GET',
		    url : url,
		   }).then(function successCallback(response) {
		   $scope.listUserJson = response.data;
		   }, function errorCallback(response) {
		    console.log(response.statusText);
		   });
}
$scope.initUser();
});

app.controller('UserAccessController', function ($scope,DTOptionsBuilder, DTColumnBuilder, DTColumnDefBuilder) {
	
	$scope.listUserAccessJson =[{permissionScreen: "Customer",addPerm: true, editPerm: true, delPerm: true, viewPerm: true, reportPerm: true},
								  {permissionScreen: "vendor",addPerm: true, editPerm: true, delPerm: true, viewPerm: true, reportPerm: true},
								  {permissionScreen: "Billing",addPerm: true, editPerm: true, delPerm: true, viewPerm: true, reportPerm: true},
								  {permissionScreen: "Product",addPerm: true, editPerm: true, delPerm: true, viewPerm: true, reportPerm: true}];				
});
app.controller('BillingController',function ($compile,$scope, $window,DTOptionsBuilder, DTColumnBuilder, DTColumnDefBuilder,$http,$resource,$location, $q,$timeout,toastr,multipartForm) {
	$scope.file = {};
	$scope.customerInvoice={fromdate:"",todate:"",truckno:""};
	$scope.vendorInvoice={fromdate:"",todate:"",truckno:""};
	$scope.customerView={fromdate:"",todate:"",customername:""};
	$scope.vendorView={fromdate:"",todate:"",vendorname:""};
	$scope.checkedValue=[];
	$scope.checkedVendorValue=[];
	$scope.listBillingJson =[{customerName: "SAI Sakthi",shipperName: "xyzz", consignorName: "ABCCC", billingDetails: {}},
							  {customerName: "Samsang",shipperName: "ABCCC", consignorName: "ABCCC", billingDetails: {}},
							  {customerName: "titan",shipperName: "ABCCC", consignorName: "ABCCC",billingDetails: {}},
							  {customerName: "sonaata",shipperName: "ABCCC", consignorName: "ABCCC", billingDetails: {}}];	
	 /* $scope.customerInvoiceJson =[{id:"1",loadNo: "23678",datetime: "1-Apr-2019", invoiceNo: "7345300022", origin: "NEMAM",customerName:"HCCBPL REDHILLS DEPOT",destination:"POOCHIATHIPATTU",truckno: "TN3QU2333", truckType: "TRS", noOfCase: "1123",opkm:"678",clskm:"788",diffKM: "100", perkmchargecustomer: "330", freightAmtCust: "2000",advance:"",discount:"1000",grandTotal:""},
								{id:"2",loadNo: "2008",datetime: "1-Apr-2019", invoiceNo: "7345300022", origin: "NEMAM",customerName:"HCCBPL REDHILLS DEPOT",destination:"POOCHIATHIPATTU",truckno: "TN3QU2333", truckType: "TRS", noOfCase: "1123",opkm:"678",clskm:"788",diffKM: "100", perkmchargecustomer: "330", freightAmtCust: "1000",advance:"500",discount:"",grandTotal:""},
								{id:"3",loadNo: "2998",datetime: "1-Apr-2019", invoiceNo: "7345300022", origin: "NEMAM",customerName:"HCCBPL REDHILLS DEPOT",destination:"POOCHIATHIPATTU",truckno: "TN3QU2333", truckType: "TRS", noOfCase: "1123",opkm:"678",clskm:"788",diffKM: "100", perkmchargecustomer: "330", freightAmtCust: "500",advance:"",discount:"200",grandTotal:""},
								{id:"4",loadNo: "23678",datetime: "1-Apr-2019", invoiceNo: "7345300022", origin: "NEMAM",customerName:"HCCBPL REDHILLS DEPOT",destination:"POOCHIATHIPATTU",truckno: "TN3QU2333", truckType: "TRS", noOfCase: "1123",opkm:"678",clskm:"788",diffKM: "100", perkmchargecustomer: "330", freightAmtCust: "2000",advance:"100",discount:"",grandTotal:""},
								{id:"5",loadNo: "20002",datetime: "1-Apr-2019", invoiceNo: "7345300022", origin: "NEMAM",customerName:"HCCBPL REDHILLS DEPOT",destination:"POOCHIATHIPATTU",truckno: "TN3QU2333", truckType: "TRS", noOfCase: "1123",opkm:"678",clskm:"788",diffKM: "100", perkmchargecustomer: "330", freightAmtCust: "400",advance:"",discount:"400",grandTotal:""},
								{id:"6",loadNo: "23",datetime: "1-Apr-2019", invoiceNo: "7345300022", origin: "NEMAM",customerName:"HCCBPL REDHILLS DEPOT",destination:"POOCHIATHIPATTU",truckno: "TN3QU2333", truckType: "TRS", noOfCase: "1123",opkm:"678",clskm:"788",diffKM: "100", perkmchargecustomer: "330", freightAmtCust: "3000",advance:"400",discount:"",grandTotal:""}]; */	
	$scope.customerInvoiceJson =[];
	$scope.vendorInvoiceJson =[];
	$scope.customerViewList=[];
	$scope.vendorViewList =[];
	$scope.criteriaCust = {};
	$scope.criteriaView = {};
	/* $scope.vendorInvoiceJson =[{id:"1",loadNo: "23678",datetime: "1-Apr-2019", invoiceNo: "7345300022", origin: "NEMAM",customerName:"HCCBPL REDHILLS DEPOT",destination:"POOCHIATHIPATTU",truckno: "TN3QU2333", truckType: "TRS", noOfCase: "1123",opkm:"678",clskm:"788",diffKM: "100", perkmchargecustomer: "330", freightAmtCust: "2000",advance:"",discount:"1000",grandTotal:""},
		{id:"2",loadNo: "2008",datetime: "1-Apr-2019", invoiceNo: "7345300022", origin: "NEMAM",customerName:"HCCBPL REDHILLS DEPOT",destination:"POOCHIATHIPATTU",truckno: "TN3QU2333", truckType: "TRS", noOfCase: "1123",opkm:"678",clskm:"788",diffKM: "100", perkmchargecustomer: "330", freightAmtCust: "1000",advance:"500",discount:"",grandTotal:""},
		{id:"3",loadNo: "2998",datetime: "1-Apr-2019", invoiceNo: "7345300022", origin: "NEMAM",customerName:"HCCBPL REDHILLS DEPOT",destination:"POOCHIATHIPATTU",truckno: "TN3QU2333", truckType: "TRS", noOfCase: "1123",opkm:"678",clskm:"788",diffKM: "100", perkmchargecustomer: "330", freightAmtCust: "500",advance:"",discount:"200",grandTotal:""},
		{id:"4",loadNo: "23678",datetime: "1-Apr-2019", invoiceNo: "7345300022", origin: "NEMAM",customerName:"HCCBPL REDHILLS DEPOT",destination:"POOCHIATHIPATTU",truckno: "TN3QU2333", truckType: "TRS", noOfCase: "1123",opkm:"678",clskm:"788",diffKM: "100", perkmchargecustomer: "330", freightAmtCust: "2000",advance:"100",discount:"",grandTotal:""},
		{id:"5",loadNo: "20002",datetime: "1-Apr-2019", invoiceNo: "7345300022", origin: "NEMAM",customerName:"HCCBPL REDHILLS DEPOT",destination:"POOCHIATHIPATTU",truckno: "TN3QU2333", truckType: "TRS", noOfCase: "1123",opkm:"678",clskm:"788",diffKM: "100", perkmchargecustomer: "330", freightAmtCust: "400",advance:"",discount:"400",grandTotal:""},
		{id:"6",loadNo: "23",datetime: "1-Apr-2019", invoiceNo: "7345300022", origin: "NEMAM",customerName:"HCCBPL REDHILLS DEPOT",destination:"POOCHIATHIPATTU",truckno: "TN3QU2333", truckType: "TRS", noOfCase: "1123",opkm:"678",clskm:"788",diffKM: "100", perkmchargecustomer: "330", freightAmtCust: "3000",advance:"400",discount:"",grandTotal:""}]; */
	$scope.checked=false;
/* 	$scope.toggleAll = function(selectAll, selectedItems) {
        for (var id in selectedItems) {
            if (selectedItems.hasOwnProperty(id)) {
                selectedItems[id] = selectAll;
            }
        }
    };
 $scope.toggleOne= function(selectedItems) {
        for (var id in selectedItems) {
            if (selectedItems.hasOwnProperty(id)) {
                if(!selectedItems[id]) {
                	$scope.selectAll = false;
                    return;
                }
            }
        }
        $scope.selectAll = true;
    };
	//vendor datatable
	 //var bm = $scope;
	 $scope.selected = {};
	 $scope.selectAll = false;
	 $scope.toggleAll = $scope.toggleAll;
	 $scope.toggleOne = $scope.toggleOne;
	 $scope.dtInstance = {};
	 
	 $scope.getTableData = function() {
		    var deferred = $q.defer();
		    deferred.resolve($scope.customerInvoiceJson); 
		    return deferred.promise;
		};
	
	 var titleHtml = '<input type="checkbox" ng-model="bm.selectAll" ng-click="bm.toggleAll(bm.selectAll,bm.selected)">';

		//$scope.bm.dtOptions = DTOptionsBuilder.newOptions()fromFnPromise
		$scope.dtOptions = DTOptionsBuilder.fromSource($scope.getTableData) 
         .withPaginationType('full_numbers')
         .withOption('createdRow', function(row, data, dataIndex) {
            // Recompiling so we can bind Angular directive to the DT
            $compile(angular.element(row).contents())($scope);
        })
        	.withOption('headerCallback', function(header) {
            if (!$scope.headerCompiled) {
                // Use this headerCompiled field to only compile header once
                $scope.headerCompiled = true;
                $compile(angular.element(header).contents())($scope);
            }
        })
		        .withOption('scrollY', '300px')
		        .withOption('scrollX', '100%')
		        .withOption('scrollCollapse', true)
		        .withFixedColumns({
		            leftColumns: 1,
		            rightColumns: 1
		        });
	
		$scope.dtColumns = [
	        DTColumnBuilder.newColumn(null).withTitle(titleHtml)
	            .renderWith(function(data, type, full, meta) {
	            	$scope.selected[full.id] = false;
	                return '<input type="checkbox" ng-model="$scope.selected[' + data.id + ']" ng-click="$scope.toggleOne($scope.selected)">';
	            }), 
	           
	        	DTColumnBuilder.newColumn('LRNO').withTitle('LRNO'),
	            DTColumnBuilder.newColumn('date').withTitle('date'),
	            DTColumnBuilder.newColumn('invoiceNo').withTitle('invoiceNo'),
	            DTColumnBuilder.newColumn('origin').withTitle('origin'),
	            DTColumnBuilder.newColumn('customerName').withTitle('customerName'),
	            DTColumnBuilder.newColumn('destination').withTitle('destination'),
	            DTColumnBuilder.newColumn('truckNo').withTitle('truckNo'),
	            DTColumnBuilder.newColumn('truckType').withTitle('truckType'),
	            DTColumnBuilder.newColumn('noOfCase').withTitle('noOfcase'),
	            DTColumnBuilder.newColumn('opKms').withTitle('opkms'),
	            DTColumnBuilder.newColumn('clsKms').withTitle('clskms'),
	            DTColumnBuilder.newColumn('totalkms').withTitle('totalkms'),
	            DTColumnBuilder.newColumn('forKms').withTitle('forkms'),
	            DTColumnBuilder.newColumn('tRTypeFixed').withTitle('tRTypeFixed'),
	            DTColumnBuilder.newColumn('advance').withTitle('advance'),
	            DTColumnBuilder.newColumn('grandTotal').withTitle('grandTotal')
	           // DTColumnBuilder.newColumn(null).withTitle('Action')
	    ]; 
     */
		 
    /*  $scope.settings = {
		      selectAll: false
		    } */
		    
		    
	
	$scope.saveInArray =function(index){
    	 if($scope.customerInvoiceJson[index].checked) {
    	      $scope.checkedValue.push($scope.customerInvoiceJson[index]);
    	    } else {
    	       var newIndex = $scope.checkedValue.map(function(e) { return e.loadno; }).indexOf($scope.customerInvoiceJson[index].loadno);
    	       // for compare instead of "loadNo" you should use that field is unique. ie: e.uniqueField
    	       // and $scope.customerInvoiceJson[index].uniqueField
    	       if(newIndex !== -1)
    	          $scope.checkedValue.splice(newIndex,1);
    	    }
     }
	$scope.saveVendorInArray =function(index){
   	 if($scope.vendorInvoiceJson[index].checked) {
   	      $scope.checkedVendorValue.push($scope.vendorInvoiceJson[index]);
   	    } else {
   	       var newIndex = $scope.checkedVendorValue.map(function(e) { return e.loadno; }).indexOf($scope.vendorInvoiceJson[index].loadno);
   	       // for compare instead of "loadNo" you should use that field is unique. ie: e.uniqueField
   	       // and $scope.customerInvoiceJson[index].uniqueField
   	       if(newIndex !== -1)
   	          $scope.checkedVendorValue.splice(newIndex,1);
   	    }
    }
	$scope.init_Billing =function(){
		 /* $('#datetimepicker_billDate').datetimepicker({
		        format: 'DD/MM/YYYY'
		    }); 
		    $('#datetimepicker_billvenDate').datetimepicker({
		        format: 'DD/MM/YYYY'
		    });*/
		    $('#datetimepicker_startBillDate').datetimepicker({
		        format: 'DD/MM/YYYY'
		    });
		    $('#datetimepicker_endBillDate').datetimepicker({
		        format: 'DD/MM/YYYY'
			});
			$('#datetimepicker_fromdate').datetimepicker({
		        format: 'MM/DD/YYYY'
			});
			$('#datetimepicker_todate').datetimepicker({
		        format: 'MM/DD/YYYY'
			});
			$('#datetimepicker_fromvendordate').datetimepicker({
		        format: 'MM/DD/YYYY'
			});
			$('#datetimepicker_tovendordate').datetimepicker({
		        format: 'MM/DD/YYYY'
			});
			$('#datetimepicker_fromcustview').datetimepicker({
		        format: 'DD/MM/YYYY'
			});
			$('#datetimepicker_tocustview').datetimepicker({
		        format: 'DD/MM/YYYY'
			});
			
			$('#datetimepicker_custinvoicedate').datetimepicker({
		        format: 'DD/MM/YYYY'
			});
			
			$('#datetimepicker_veninvoicedate').datetimepicker({
		        format: 'DD/MM/YYYY'
			});
			var bm = $scope;
			bm.dtInstanceCallback = function(instance) {
			 	bm.dtInstance = instance;
	    };
	    
	    bm.dtOptions = DTOptionsBuilder.newOptions()
			        .withOption('scrollY', '300px')
			        .withOption('scrollX', '100%')
			        .withOption('scrollCollapse', true)
			        .withFixedColumns({
			            leftColumns: 1,
			            rightColumns: 1
			        });
	    
	}
	/* $scope.addKmsandFixed =function(kms,fix){

angular.forEach($scope.customerInvoiceJson, function(value, key) {
  //this.push(key + ': ' + value);
  value.forKms=kms;
  value.tRTypeFixed=fix;
  value.grandTotal=(value.totalkms * value.forKms)+value.tRTypeFixed -value.advance;
});
	}; */
	

	$scope.searchcustItem =function(){
		if($scope.customerInvoice.fromdate==""){
			 toastr.error('Please enter From date');
			return;
		}else if($scope.customerInvoice.todate==""){
			 toastr.error('Please enter To date');
			return;
		}else if($scope.customerInvoice.truckno==""){
			 toastr.error('Please enter Truck No');
			return;
		}else{
			var url=location.origin +"/api/v1/customerinvoicelist";
			 $http({
				    method : 'GET',
				    url : url,
				    params: $scope.customerInvoice,
				   }).then(function successCallback(response) {
				   $scope.customerInvoiceJson = response.data;
				   $scope.checkedValue=[];
				   }, function errorCallback(response) {
				    console.log(response.statusText);
				   });
		}
		
	};
	
	$scope.searchvenItem =function(){
		if($scope.vendorInvoice.fromdate==""){
			 toastr.error('Please enter From date');
			return;
		}else if($scope.vendorInvoice.todate==""){
			 toastr.error('Please enter To date');
			return;
		}else if($scope.vendorInvoice.truckno==""){
			 toastr.error('Please enter Truck No');
			return;
		}else{
			var url=location.origin +"/api/v1/vendorinvoicelistintripsheet";
			 $http({
				    method : 'GET',
				    url : url,
				    params: $scope.vendorInvoice,
				   }).then(function successCallback(response) {
				   $scope.vendorInvoiceJson = response.data;
				   $scope.checkedVendorValue=[];
				   }, function errorCallback(response) {
				    console.log(response.statusText);
				   });
		}
		
	};
	
	$scope.searchcustView =function(){
		if($scope.customerView.fromdate=="" || $scope.customerView.fromdate== undefined){
			 toastr.error('Please enter From date');
			return;
		}else if($scope.customerView.todate=="" || $scope.customerView.todate==undefined){
			 toastr.error('Please enter To date');
			return;
		}else if($scope.customerView.customername=="" || $scope.customerView.customername== undefined){
			 toastr.error('Please enter CustomerName');
			return;
		}else{
			var url=location.origin +"/api/v1/invoicelistincustomer";
			 $http({
				    method : 'GET',
				    url : url,
				    params: $scope.customerView,
				   }).then(function successCallback(response) {
				   $scope.customerViewList = response.data;
				   }, function errorCallback(response) {
				    console.log(response.statusText);
				   });
		}
		
	};
	
	$scope.searchvenView =function(){
		if($scope.vendorView.fromdate=="" || $scope.vendorView.fromdate== undefined){
			 toastr.error('Please enter From date');
			return;
		}else if($scope.vendorView.todate=="" || $scope.vendorView.todate== undefined){
			 toastr.error('Please enter To date');
			return;
		}else if($scope.vendorView.vendorname=="" || $scope.vendorView.vendorname== undefined){
			 toastr.error('Please enter CustomerName');
			return;
		}else{
			var url=location.origin +"/api/v1/vendorinvoicelistinvendor";
			 $http({
				    method : 'GET',
				    url : url,
				    params: $scope.vendorView,
				   }).then(function successCallback(response) {
				   $scope.vendorViewList = response.data;
				   }, function errorCallback(response) {
				    console.log(response.statusText);
				   });
		}
		
	};
	
	$scope.resetvenView=function() {
		$scope.vendorView={fromdate:"",todate:"",vendorname:""};
		$scope.initvenView();
	}
	
	$scope.resetcustView=function() {
		$scope.initView();
		$scope.customerView={fromdate:"",todate:"",customername:""};
		//$scope.$digest();
	}
	
	$scope.custInvoicePrint=function() {
		var xmlhttp;
		if (window.XMLHttpRequest) {// code for IE7+, Firefox, Chrome, Opera, Safari
			xmlhttp = new XMLHttpRequest();
			var myWindow = $window.open('', '', 'width=2000,height=1000');
			  $(myWindow.document.head).append("<link rel='stylesheet' href='https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css'>");
			  var scriptjquery = document.createElement( 'script' );
			  scriptjquery.type = 'text/javascript';
			  scriptjquery.src = 'https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js';
			  $(myWindow.document.head).append( scriptjquery );
			  var scriptbootstrap = document.createElement( 'script' );
			  scriptbootstrap.type = 'text/javascript';
			  scriptbootstrap.src = 'https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js';
			  $(myWindow.document.head).append( scriptbootstrap );
			  
			myWindow.document.write("<body style='font: bold; font-size: xxx-small; line-height: 0.5cm;'><img src=\"img/sse.png height='42px' width='42px'\"><h1 align='center'>SSE LOGISTICS PRIVATE LIMITED</h1> ");
							//+ "<h4  align='center'>484, Pantheon Plaza, Pantheon Road, Egmore, Chennai - 600 008. INDIA</h4>"
							//+ "<h4  align='center'>Ph:+91-44-1111 4444, 2222 3333  FAX:+91-44-5559-5555</h4>");
			
			//$(myWindow.document.body).append("<div class='container'><div class='row'><div class='col-xs-5'><div class='panel panel-default'><div class='panel-heading'><h3 class='panel-title'>Company Details</h3></div><div class='panel-body'><dl class='dl-horizontal'><dt>Name</dt><dd><strong>Acme Corporation</strong></dd><dt>Industry</dt><dd>Software Development</dd><dt>Address</dt><dd>Field 3, Moon</dd><dt>Phone</dt><dd>123.4456.4567</dd><dt>Email</dt><dd>mainl@acme.com</dd><dt>Tax NO</dt><dd class='mono'>123456789</dd><dt>Tax Office</dt><dd>A' Moon</dd></div></div></div><div class='col-xs-7'><div class='panel panel-default'><div class='panel-heading'><h3 class='panel-title'>Customer Details</h3></div><div class='panel-body'><dl class='dl-horizontal'><dt>Name</dt><dd>Microsoft Corporation</dd><dt>Industry</dt><dd>Software Development</dd><dt>Address</dt><dd>One Microsoft Way Redmond, WA 98052-7329, USA</dd><dt>Phone</dt><dd>(425) 882-8080</dd><dt>Email</dt><dd>contact@microsoft.com</dd><dt>Tax NO</dt><dd class='mono'>123456789</dd><dt>&nbsp;</dt><dd>&nbsp;</dd></div></div></div></div></div>");
			$(myWindow.document.body).append("<table border='1'; cellpadding=0.1; cellspacing=5; align='center' >"
							+ "<tr><td><b>FROM</b></td><td><b>TO</b></td>"
							+ "<td>DATE</td><td>VEHICLETYPE</td><td>VEHICLENO </td><td>DRIVERNAME</td>" + "</tr><tr><td><b> " +  $scope.trip.from
							+ "   </b></td><td><b>" + $scope.trip.to + "</b></td>" + "<td>" + $scope.trip.date
							+ "</td><td>" + $scope.trip.vehicleType + "</td><td>" + $scope.trip.vehicleNo + " </td><td>"+$scope.trip.driverName+"</td>"
							+ "</tr></table>");
			$(myWindow.document.body).append("");
			
			$(myWindow.document).close();
			$(myWindow).focus();
			$(myWindow).print();
			$(myWindow).close();
		} else {// code for IE6, IE5
			xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
		}
		xmlhttp.onreadystatechange = function() {
			if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
				document.getElementById("myDiv").innerHTML = xmlhttp.responseText;
			}
		}
		
		xmlhttp.send();
	}
	$scope.addKmsandFixedVendor =function(kms,fix){
		angular.forEach($scope.vendorInvoiceJson, function(value, key) {
		  value.forKms=kms;
		  value.tRTypeFixed=fix;
		  value.grandTotal=(value.totalkms * value.forKms)+value.tRTypeFixed -value.advance;
		});
	};
	$scope.closeUpload =function(){
		$("#uploadDiv").css("display","none");
	};
	
	$scope.openUpload =function(){
		$("#uploadDiv").css("display","block");
	};
	$scope.removeInvoice  =function(index){
		$scope.customerInvoiceJson.splice(index,1);
		//$scope.bm.dtInstance.rerender();
	};
	
	$scope.calculateTotal =function(){
		$scope.grandTotalList={totaltrip:"",customername:"",invoiceNo:"",truckno:"",trucktype:"",totalkm:0,totalcase:0,totalkmpercharge:0,totalfreightamt:0,totaladvance:0,totaldiscount:0,netamount:0,paymentstatus:"",receiptnumber:"",leakage:""};
		angular.forEach($scope.checkedValue, function(value, key) {
			$scope.grandTotalList.customername = value.origin;
			$scope.grandTotalList.truckno = value.truckno;
			$scope.grandTotalList.trucktype = value.truckType;
			$scope.grandTotalList.totalkm += parseInt(value.diffKM)? parseInt(value.diffKM):0;
			$scope.grandTotalList.totalcase +=parseInt(value.noOfCase)?parseInt(value.noOfCase):0;;
			$scope.grandTotalList.totalkmpercharge +=parseInt(value.perkmchargecustomer)?parseInt(value.perkmchargecustomer):0;;
			$scope.grandTotalList.totalfreightamt +=parseInt(value.freightAmtCust)?parseInt(value.freightAmtCust):0;
			$scope.grandTotalList.totaladvance +=parseInt(value.advance)?parseInt(value.advance):0;
			$scope.grandTotalList.totaldiscount +=parseInt(value.discount)? parseInt(value.discount):0;
		});
		$scope.grandTotalList.totaltrip=$scope.checkedValue.length;
		$scope.grandTotalList.netamount =(parseInt($scope.grandTotalList.totalkmpercharge) ?parseInt($scope.grandTotalList.totalkmpercharge) :0) + (parseInt($scope.grandTotalList.totalfreightamt)?parseInt($scope.grandTotalList.totalfreightamt):0);
		var adCount =(parseInt($scope.grandTotalList.totaldiscount) ? parseInt($scope.grandTotalList.totaldiscount): 0) +(parseInt($scope.grandTotalList.totaladvance) ? parseInt($scope.grandTotalList.totaladvance): 0);
		$scope.grandTotalList.netamount =(parseInt($scope.grandTotalList.netamount) ? parseInt($scope.grandTotalList.netamount): 0) - (parseInt(adCount) ? parseInt(adCount):0);
		console.log($scope.grandTotalList);
	};
	
	$scope.addLeakTotal =function(leak){
		$scope.grandTotalList.leakage=parseInt(leak) ? parseInt(leak): 0;
		$scope.grandTotalList.netamount =(parseInt($scope.grandTotalList.netamount) ? parseInt($scope.grandTotalList.netamount): 0) - (parseInt(leak) ? parseInt(leak): 0);
	}
	
	$scope.calculateVendorTotal =function(){
		$scope.grandTotalVendorList={totaltrip:"",vendorname:"",invoiceNo:"",truckno:"",trucktype:"",totalkm:0,totalcase:0,totalkmpercharge:0,totalfreightamt:0,totaladvance:0,totaldiscount:0,netamount:0,paymentstatus:"",receiptnumber:"",leakage:""};
		angular.forEach($scope.checkedVendorValue, function(value, key) {
			$scope.grandTotalVendorList.vendorname = value.destination;
			$scope.grandTotalVendorList.truckno = value.truckno;
			$scope.grandTotalVendorList.trucktype = value.truckType;
			
			$scope.grandTotalVendorList.totalkm += parseInt(value.diffKM)? parseInt(value.diffKM):0;
			$scope.grandTotalVendorList.totalcase +=parseInt(value.noOfCase)?parseInt(value.noOfCase):0;;
			$scope.grandTotalVendorList.totalkmpercharge +=parseInt(value.perkmchargecustomer)?parseInt(value.perkmchargecustomer):0;;
			$scope.grandTotalVendorList.totalfreightamt +=parseInt(value.freightAmtCust)?parseInt(value.freightAmtCust):0;
			$scope.grandTotalVendorList.totaladvance +=parseInt(value.advance)?parseInt(value.advance):0;
			$scope.grandTotalVendorList.totaldiscount +=parseInt(value.discount)? parseInt(value.discount):0;
		});
		$scope.grandTotalVendorList.totaltrip=$scope.checkedVendorValue.length;
		$scope.grandTotalVendorList.netamount =(parseInt($scope.grandTotalVendorList.totalkmpercharge) ?parseInt($scope.grandTotalVendorList.totalkmpercharge) :0) + (parseInt($scope.grandTotalVendorList.totalfreightamt)?parseInt($scope.grandTotalVendorList.totalfreightamt):0);
		var adVenCount =(parseInt($scope.grandTotalVendorList.totaldiscount) ? parseInt($scope.grandTotalVendorList.totaldiscount): 0) +(parseInt($scope.grandTotalVendorList.totaladvance) ? parseInt($scope.grandTotalVendorList.totaladvance): 0);
		$scope.grandTotalVendorList.netamount =(parseInt($scope.grandTotalVendorList.netamount) ? parseInt($scope.grandTotalVendorList.netamount): 0) - (parseInt(adVenCount) ? parseInt(adVenCount):0);
		console.log($scope.grandTotalVendorList);
		
	} 
	
	$scope.addVendorLeakTotal =function(leak){
		$scope.grandTotalVendorList.leakage=parseInt(leak) ? parseInt(leak): 0;
		$scope.grandTotalVendorList.netamount =(parseInt($scope.grandTotalVendorList.netamount) ? parseInt($scope.grandTotalVendorList.netamount): 0) - (parseInt(leak) ? parseInt(leak): 0);
	}
	$scope.resetCustomerInvoice =function(){
		$scope.customerInvoice={fromdate:"",todate:"",truckno:""};
		$scope.customerInvoiceJson =[];
		$scope.grandTotalList={totaltrip:"",customername:"",invoiceNo:"",truckno:"",trucktype:"",totalkm:0,totalcase:0,totalkmpercharge:0,totalfreightamt:0,totaladvance:0,totaldiscount:0,netamount:0,paymentstatus:"",receiptnumber:"",leakage:""};
	}
	$scope.resetVendorInvoice =function(){
		$scope.vendorInvoice={fromdate:"",todate:"",truckno:""};
		$scope.vendorInvoiceJson =[];
		$scope.grandTotalVendorList={totaltrip:"",vendorname:"",invoiceNo:"",truckno:"",trucktype:"",totalkm:0,totalcase:0,totalkmpercharge:0,totalfreightamt:0,totaladvance:0,totaldiscount:0,netamount:0,paymentstatus:"",receiptnumber:"",leakage:""};
	}
	$scope.saveCustomerInvoice =function(){
		$scope.custcallBackdata={invoiceid:"",loadnnumber:[]};
		var url = location.origin +"/api/v1/createcustomerinvoice";
		    $http({
		        method : 'POST',
		        url : url,
		        data : angular.toJson($scope.grandTotalList),
		        headers : {
		        'Content-Type' : 'application/json'
		        }
		        }).then(function (response) {
		        	$scope.custcallBackdata.invoiceid=response.data.customerinvoiceid;
		        	angular.forEach($scope.checkedValue, function(list, key) {
		        		$scope.custcallBackdata.loadnnumber.push(list.loadno);
		        	});
		        	$scope.updateBilledTrip($scope.custcallBackdata);
		            //toastr.success('Data added successfully');
		        }, function error(response) {
		        	toastr.success('Data not added');
		          console.log(response.status);
		        });
	}
	
	$scope.updateBilledTrip =function(data){
		var url = location.origin +"/api/v1/updatecustomerinvoice";
		$http({
	        method : 'PUT',
	        url : url,
	        data : angular.toJson(data),
	        headers : {
	        'Content-Type' : 'application/json'
	        }
	        }).then(function (response) {
	        	if(response.data.status=="Updated Successfully"){
	        		$scope.customerInvoiceJson = [];
					$scope.checkedValue=[];
					$scope.grandTotalVendorList={truckNo:"",truckType:"",totalKM:0,totalCase:0,totalPerKMCharge:0,totalfreightAmt:0,totalAdvance:0,totalDiscount:0,NetAmount:0};
					toastr.success('Billed successfully');
	        	}
	        }, function error(response) {
	        	toastr.error('Not able to Bill');
	          console.log(response.status);
	        });
	}
$scope.saveVendorInvoice =function(){
		
		var url = location.origin +"/api/v1/createvendorinvoice";
		    $http({
		        method : 'POST',
		        url : url,
		        data : angular.toJson($scope.grandTotalVendorList),
		        headers : {
		        'Content-Type' : 'application/json'
		        }
		        }).then(function (response) {
		            toastr.success('Data added successfully');
		        }, function error(response) {
		        	toastr.success('Data not added');
		          console.log(response.status);
		        });
	}
	
	$scope.removevendorInvoice  =function(index){
		$scope.vendorInvoiceJson.splice(index,1);
	};
	$scope.closeVendorUpload =function(){
		$("#uploadVendorDiv").css("display","none");
	};
	$scope.openVendorUpload =function(){
		$("#uploadVendorDiv").css("display","block");
	};
	
	$scope.initView =function(){
		var url=location.origin +"/api/v1/listcustomerinvoice";
		 $http({
			    method : 'GET',
			    url : url
			   }).then(function successCallback(response) {
			   $scope.customerViewList = response.data;
			   }, function errorCallback(response) {
			    console.log(response.statusText);
			   });
	};
	$scope.initvenView =function(){
		var url=location.origin +"/api/v1/listvendorinvoice";
		 $http({
			    method : 'GET',
			    url : url
			   }).then(function successCallback(response) {
			   $scope.vendorViewList = response.data;
			   }, function errorCallback(response) {
			    console.log(response.statusText);
			   });
	};
	$scope.calculateAmountTax =function(data){
		console.log(data);
		var amt =$scope.customerInvoiceJson.amount * $scope.customerInvoiceJson.quantity;
		$scope.customerInvoiceJson.totalAmount =amt + amt * data;
	}
	$scope.navRedirect =function(event){
		 $(".nav").find(".active").removeClass("active");
		   $(event).addClass("active");
		   var currEvent=$(event.target).attr('bind-attr');
		  if(currEvent =="customerView"){
			  $('#CustomerInvoice').hide();
			  $('#VendorInvoice').hide();
			  $('#customerView').show();
			  $('#customerView').addClass("active");
			  $scope.initView();
		  }else if(currEvent =="VendorInvoice"){
			  $('#CustomerInvoice').hide();
			  $('#VendorInvoice').show();
			  $('#customerView').hide();
			  $('#VendorInvoice').addClass("active");
			  var vm = $scope;
				vm.dtInstanceCallback = function(instance) {
				 	vm.dtInstance = instance;
		    };
		    
		    vm.dtOptions = DTOptionsBuilder.newOptions()
				        .withOption('scrollY', '300px')
				        .withOption('scrollX', '100%')
				        .withOption('scrollCollapse', true)
				        .withFixedColumns({
				            leftColumns: 1,
				            rightColumns: 1
				        }); 
		   $scope.grandTotalVendorList={totaltrip:"",vendorname:"",invoiceNo:"",truckno:"",trucktype:"",totalkm:0,totalcase:0,totalkmpercharge:0,totalfreightamt:0,totaladvance:0,totaldiscount:0,netamount:0,paymentstatus:"",receiptnumber:"",leakage:""};
		  }else if(currEvent =="CustomerInvoice"){
			  $('#CustomerInvoice').show();
			  $('#CustomerInvoice').addClass("active");
			  $('#VendorInvoice').hide();
			  $('#customerView').hide();
			 $scope.grandTotalList={totaltrip:"",customername:"",invoiceNo:"",truckno:"",trucktype:"",totalkm:0,totalcase:0,totalkmpercharge:0,totalfreightamt:0,totaladvance:0,totaldiscount:0,netamount:0,paymentstatus:"",receiptnumber:"",leakage:""};
		  }else{
			  $('#vendorView').show();
			  $('#vendorView').addClass("active");
			  $('#CustomerInvoice').hide();
			  $('#VendorInvoice').hide();
			  $('#customerView').hide();
			  $scope.initvenView();
		  }
	}
	$scope.init_Billing();
	scope=$scope;
});
app.controller('ReceiptController', function ($scope,$timeout,$http,toastr,DTOptionsBuilder, DTColumnBuilder, DTColumnDefBuilder) {
	
	$scope.listReceiptJson =[{instrumentType: "Sew",shipperName: "xyzz", consignorName: "ABCCC", billingDetails: {}},
							  {instrumentType: "Software",shipperName: "ABCCC", consignorName: "ABCCC", billingDetails: {}},
							  {instrumentType: "Equipment",shipperName: "ABCCC", consignorName: "ABCCC",billingDetails: {}},
							  {instrumentType: "sonaata",shipperName: "ABCCC", consignorName: "ABCCC", billingDetails: {}}];				
	
	$scope.paymentJson =[{paymentType: "",instrumentDate: "", amount: "", instrumentNo:""}];	
	$scope.paymentvenJson =[{paymentType: "",instrumentDate: "", amount: "", instrumentNo:""}];	
	 $scope.customerpaymentList =[];
	 $scope.vendorpaymentList =[];
	$scope.customerPayment={fromdate:"",todate:"",customername:""};
	$scope.vendorPayment={fromdate:"",todate:"",customername:""};
	$scope.checkedcustPaymentValue=[];
	$scope.checkedvenPaymentValue=[];
	$scope.commoncustList={custreceiptDate:"",totalamount:0};
	$scope.commonvenList={venreceiptDate:"",totalamount:0};
	
	  
	$scope.dtInstanceCallback = function(instance) {
		$scope.dtInstance = instance;
 	};
 
 	$scope.dtOptions = DTOptionsBuilder.newOptions()
		        .withOption('scrollY', '300px')
		        .withOption('scrollX', '100%')
		        .withOption('scrollCollapse', true)
		        .withFixedColumns({
		            leftColumns: 1,
		            rightColumns: 1
		        });
	$scope.deletepaymentIndex =function(index){
		$scope.paymentJson.splice(index,1);		
	}
 	$scope.addNewpayment =function(){
 		$scope.paymentJson.push({paymentType: "",instrumentDate: "", amount: "", instrumentNo:""}); 		
 	}
 	$scope.calculatepaymentTotal =function(){
 		$scope.commoncustList={custreceiptDate:"",totalamount:0};
 		$scope.paymentJson =[{paymentType: "",instrumentDate: "", amount: "", instrumentNo:""}];
 		angular.forEach($scope.checkedcustPaymentValue, function(value, key) {
 			$scope.commoncustList.totalamount +=parseInt(value.netamount)?parseInt(value.netamount):0;;
		});
 	}
 	$scope.calculatevenpaymentTotal =function(){
 		$scope.commonvenList={venreceiptDate:"",totalamount:0};
 		$scope.paymentvenJson =[{paymentType: "",instrumentDate: "", amount: "", instrumentNo:""}];
 		angular.forEach($scope.checkedcustPaymentValue, function(value, key) {
 			$scope.commoncustList.totalamount +=parseInt(value.netamount)?parseInt(value.netamount):0;;
		});
 	}
 $scope.checkcustPayInArray =function(index){
	 if($scope.customerpaymentList[index].checked) {
	      $scope.checkedcustPaymentValue.push($scope.customerpaymentList[index]);
	    } else {
	       var newIndex = $scope.checkedcustPaymentValue.map(function(e) { return e.customerinvoiceid; }).indexOf($scope.customerpaymentList[index].customerinvoiceid);
	       // for compare instead of "loadNo" you should use that field is unique. ie: e.uniqueField
	       // and $scope.customerInvoiceJson[index].uniqueField
	       if(newIndex !== -1)
	          $scope.checkedcustPaymentValue.splice(newIndex,1);
	    }
 }
 
 $scope.checkvenPayInArray =function(index){
	 if($scope.vendorpaymentList[index].checked) {
	      $scope.checkedvenPaymentValue.push($scope.vendorpaymentList[index]);
	    } else {
	       var newIndex = $scope.checkedvenPaymentValue.map(function(e) { return e.vendorinvoiceid; }).indexOf($scope.vendorpaymentList[index].vendorinvoiceid);
	       // for compare instead of "loadNo" you should use that field is unique. ie: e.uniqueField
	       // and $scope.customerInvoiceJson[index].uniqueField
	       if(newIndex !== -1)
	          $scope.checkedvenPaymentValue.splice(newIndex,1);
	    }
 }
 
 $scope.searchcustPaymentItem =function(){
		if($scope.customerPayment.fromdate=="" || $scope.customerPayment.fromdate== undefined){
			 toastr.error('Please enter From date');
			return;
		}else if($scope.customerPayment.todate=="" || $scope.customerPayment.todate==undefined){
			 toastr.error('Please enter To date');
			return;
		}else if($scope.customerPayment.customername=="" || $scope.customerPayment.customername== undefined){
			 toastr.error('Please enter CustomerName');
			return;
		}else{
			var url=location.origin +"/api/v1/invoicelistincustomer";
			 $http({
				    method : 'GET',
				    url : url,
				    params: $scope.customerPayment,
				   }).then(function successCallback(response) {
				   $scope.customerpaymentList = response.data;
				   }, function errorCallback(response) {
				    console.log(response.statusText);
				   });
		}
		
	};
	
	$scope.saveCustPayment =function(){
		var url = location.origin +"/api/v1/";
		$scope.checkCredit=false;
		$scope.checkamt=0;
		angular.forEach($scope.paymentJson, function(value, key) {
			if(value.paymentType =="Credit"){
				$scope.checkCredit=true;
			}
			value.custreceiptDate =$scope.commoncustList.custreceiptDate;
			$scope.checkamt +=parseInt(value.amount)?parseInt(value.amount):0;
 			//$scope.commoncustList.totalamount +=parseInt(value.netamount)?parseInt(value.netamount):0;;
		});
		if($scope.checkCredit){
			if($scope.commoncustList.totalamount ==$scope.checkamt){
				toastr.success('matched');
				
				    $http({
				        method : 'POST',
				        url : url,
				        data : angular.toJson($scope.item),
				        headers : {
				        'Content-Type' : 'application/json'
				        }
				        }).then(function (response) {
				            //$scope.listCustomerJson = response.data;
				            toastr.success('Data added successfully');
				        	//$scope.initcust();
				        }, function error(response) {
				        	toastr.success('Data not added');
				          console.log(response.status);
				        });
			}else{
				toastr.error('Amount does not match');
			}
			
		}else{
			if($scope.commoncustList.totalamount <=$scope.checkamt){
				toastr.success('Matched');
				$http({
			        method : 'POST',
			        url : url,
			        data : angular.toJson($scope.item),
			        headers : {
			        'Content-Type' : 'application/json'
			        }
			        }).then(function (response) {
			            //$scope.listCustomerJson = response.data;
			            toastr.success('Data added successfully');
			        	//$scope.initcust();
			        }, function error(response) {
			        	toastr.success('Data not added');
			          console.log(response.status);
			        });
			}else{
				toastr.error('Invoice and Receipt Amount is not matched..');
			}
			
		}
	}
	$scope.calculatePaymentAmountTax =function(data){
		console.log(data);
		var amt =$scope.paymentJson.amount * $scope.paymentJson.quantity;
		$scope.paymentJson.totalAmount =amt + amt * data;
	}
	$scope.init_Inst =function(){
		 $('#datetimepicker_custfromrepbill').datetimepicker({
		        format: 'DD/MM/YYYY'
		    });
		 $('#datetimepicker_custtorepbill').datetimepicker({
		        format: 'DD/MM/YYYY'
		    });
		 $('#datetimepicker_venfromrepbill').datetimepicker({
		        format: 'DD/MM/YYYY'
		    });
		 $('#datetimepicker_ventorepbill').datetimepicker({
		        format: 'DD/MM/YYYY'
		    });
		 $('#datetimepicker_custreceiptDate').datetimepicker({
		        format: 'DD/MM/YYYY'
		    });
		 $('#datetimepicker_venreceiptDate').datetimepicker({
		        format: 'DD/MM/YYYY'
		    });
		 
		 
		 $scope.initcustPayment();
		
	}
	
	 
	 
	 $('#datetimepicker_startBillDate1').datetimepicker({
	        format: 'DD/MM/YYYY'
	    });
	    $('#datetimepicker_endBillDate2').datetimepicker({
	        format: 'DD/MM/YYYY'
	    });
	    
	    $scope.initcustPayment =function(){
			var url=location.origin +"/api/v1/listcustomerinvoice";
			 $http({
				    method : 'GET',
				    url : url
				   }).then(function successCallback(response) {
				   $scope.customerpaymentList = response.data;
				   }, function errorCallback(response) {
				    console.log(response.statusText);
				   });
		};
		
		 $scope.initvenPayment =function(){
				var url=location.origin +"/api/v1/listvendorinvoice";
				 $http({
					    method : 'GET',
					    url : url
					   }).then(function successCallback(response) {
					   $scope.vendorpaymentList = response.data;
					   }, function errorCallback(response) {
					    console.log(response.statusText);
					   });
			};
	$scope.navRedirect =function(event){
		
		 $(".nav").find(".active").removeClass("active");
		   $(event).addClass("active");
		   var currEvent=$(event.target).attr('bind-attr');
		  if(currEvent =="view"){
			  $('#Payment').hide();
			  $('#Receipt').hide();
			  $('#view').show();
		  }else if(currEvent =="vendorPayment"){
			  $('#Payment').hide();
			  $('#Receipt').show();
			  $('#view').hide();
			  $scope.initvenPayment();
		  }else{
			  $('#Payment').show();
			  $('#Receipt').hide();
			  $('#view').hide();
			  $scope.initcustPayment();
		  }
	}
	$scope.init_Inst();
	
	 $timeout(function() { 
		 $('#datetimepicker_custinstDate').datetimepicker({
		        format: 'DD/MM/YYYY'
		    });
		 $('#datetimepicker_veninstDate').datetimepicker({
		        format: 'DD/MM/YYYY'
		    });
		 
		 }, 2000);
	scope=$scope;
});
$(document).ready(function(){
	$(".menu-toggle").click(function(e) {
        e.preventDefault();
        $("#wrapper").toggleClass("active");
	});
	
	/* $('#datetimepicker4').datetimepicker({
        format: 'DD/MM/YYYY'
    }); */

});
app.directive("panRegex", function() {

    var regexp;
    return {
        restrict: "A",
        link: function(scope, elem, attrs) {
            //regexp = /^([a-zA-Z]){5}([0-9]){4}([a-zA-Z]){1}$/;
            regexp = /^([a-zA-Z]([a-zA-Z]([a-zA-Z]([a-zA-Z]([a-zA-Z]([0-9]([0-9]([0-9]([0-9]([a-zA-Z])?)?)?)?)?)?)?)?)?)?$/;
            var char;
            elem.bind("keypress", function(event) {
                char = String.fromCharCode(event.which)
                console.log(elem.val() + char);
                if(!regexp.test(elem.val() + char))
                    event.preventDefault();
            })
        }
    }

});

app.directive("numericRegex", function() {

    var regexp;
    return {
        restrict: "A",
        link: function(scope, elem, attrs) {
            regexp = /^([0-9]){0,10}$/;
            var char;
            elem.bind("keypress", function(event) {
                char = String.fromCharCode(event.which)
                if(!regexp.test(elem.val() + char))
                    event.preventDefault();
            })
        }
    }

});



app.directive('initialDate', function () {
    return {
      link: function (scope, elem, attrs, ctrl) {
    	  console.log("hello");
    	 // $scope.initdate = function () {
    			$('#datetimepicker_fc').datetimepicker({
    			    format: 'DD/MM/YYYY'
    			});
    			$('#datetimepicker_ins').datetimepicker({
    			    format: 'DD/MM/YYYY'
    			});
    		//};
        /* var hello = function () {
          for (var i = 0; i < attrs.repeatHelloWorld; i++) {
            console.log('Hello world!');
          }
        }
        hello(); */
      }
    }
  });
  
app.directive('fileModel', ['$parse', function($parse){
    return {
        restrict: 'A',
        link: function(scope, element,attrs) {
            var model = $parse(attrs.fileModel);
            var modelSetter = model.assign;

            element.bind('change', function() {
                scope.$apply(function() {
                    modelSetter(scope, element[0].files[0]);
                })
            })
        }
    }
}]);

app.service('multipartForm', ['$http', function($http){
    this.post = function(uploadUrl, data) {
	    	var formData = new FormData();
	    	formData.append("file", data);
	    	jQuery.ajax({
	    	    url: uploadUrl,
	    	    data: formData,
	    	    cache: false,
	    	    contentType: false,
	    	    processData: false,
	    	    method: 'POST',
	    	    success: function(data){
	    	        alert(data);
	    	    }
	    	});
        }
}])
 /* function RowSelect($compile,$scope,$resource,$location, $q,$timeout,DTOptionsBuilder, DTColumnBuilder, DTColumnDefBuilder){
	 $scope.customerInvoiceJson =[{id:"1",LRNO: "23678",date: "1-Apr-2019", invoiceNo: "7345300022", origin: "NEMAM",customerName:"HCCBPL REDHILLS DEPOT",destination:"POOCHIATHIPATTU",truckNo: "TN3QU2333", truckType: "TRS", noOfCase: "1123",opKms:"678",clsKms:"788",totalkms: "100", forKms: "330", tRTypeFixed: "2000",advance:"",grandTotal:""},
									{id:"2",LRNO: "2008",date: "1-Apr-2019", invoiceNo: "7345300022", origin: "NEMAM",customerName:"HCCBPL REDHILLS DEPOT",destination:"POOCHIATHIPATTU",truckNo: "TN3QU2333", truckType: "TRS", noOfCase: "1123",opKms:"678",clsKms:"788",totalkms: "100", forKms: "330", tRTypeFixed: "1000",advance:"500",grandTotal:""},
									{id:"3",LRNO: "2998",date: "1-Apr-2019", invoiceNo: "7345300022", origin: "NEMAM",customerName:"HCCBPL REDHILLS DEPOT",destination:"POOCHIATHIPATTU",truckNo: "TN3QU2333", truckType: "TRS", noOfCase: "1123",opKms:"678",clsKms:"788",totalkms: "100", forKms: "330", tRTypeFixed: "500",advance:"",grandTotal:""},
									{id:"4",LRNO: "23678",date: "1-Apr-2019", invoiceNo: "7345300022", origin: "NEMAM",customerName:"HCCBPL REDHILLS DEPOT",destination:"POOCHIATHIPATTU",truckNo: "TN3QU2333", truckType: "TRS", noOfCase: "1123",opKms:"678",clsKms:"788",totalkms: "100", forKms: "330", tRTypeFixed: "2000",advance:"100",grandTotal:""},
									{id:"5",LRNO: "20002",date: "1-Apr-2019", invoiceNo: "7345300022", origin: "NEMAM",customerName:"HCCBPL REDHILLS DEPOT",destination:"POOCHIATHIPATTU",truckNo: "TN3QU2333", truckType: "TRS", noOfCase: "1123",opKms:"678",clsKms:"788",totalkms: "100", forKms: "330", tRTypeFixed: "400",advance:"",grandTotal:""},
									{id:"6",LRNO: "23",date: "1-Apr-2019", invoiceNo: "7345300022", origin: "NEMAM",customerName:"HCCBPL REDHILLS DEPOT",destination:"POOCHIATHIPATTU",truckNo: "TN3QU2333", truckType: "TRS", noOfCase: "1123",opKms:"678",clsKms:"788",totalkms: "100", forKms: "330", tRTypeFixed: "3000",advance:"400",grandTotal:""}];	
	 var bm = $scope;
	 bm.selected = {};
	 bm.selectAll = false;
	 bm.toggleAll = toggleAll;
	 bm.toggleOne = toggleOne;
	 bm.dtInstance = {};
	 
	 
	
	 
	 var titleHtml = '<input type="checkbox" ng-model="bm.selectAll" ng-click="bm.toggleAll(bm.selectAll,bm.selected)">';

		//$scope.bm.dtOptions = DTOptionsBuilder.newOptions()
		bm.dtOptions = DTOptionsBuilder.fromFnPromise(function() {
			
			 var defer = $q.defer();
	        defer.resolve($scope.customerInvoiceJson);
	        return defer.promise; 
            return $resource($scope.customerInvoiceJson).query().$promise;
        })
         .withOption('createdRow', function(row, data, dataIndex) {
            // Recompiling so we can bind Angular directive to the DT
            $compile(angular.element(row).contents())($scope);
        })
        	.withOption('headerCallback', function(header) {
            if (!bm.headerCompiled) {
                // Use this headerCompiled field to only compile header once
                bm.headerCompiled = true;
                $compile(angular.element(header).contents())($scope);
            }
        })
		        .withOption('scrollY', '300px')
		        .withOption('scrollX', '100%')
		        .withOption('scrollCollapse', true)
		        .withFixedColumns({
		            leftColumns: 1,
		            rightColumns: 1
		        });
	
		 bm.dtColumns = [
	        DTColumnBuilder.newColumn(null).withTitle(titleHtml).notSortable()
	            .renderWith(function(data, type, full, meta) {
	            	bm.selected[full.id] = false;
	                return '<input type="checkbox" ng-model="bm.selected[' + data.id + ']" ng-click="bm.toggleOne(bm.selected)">';
	            }), 
	            DTColumnBuilder.newColumn('LRNO').withTitle('LRNO'),
	            DTColumnBuilder.newColumn('date').withTitle('Date'),
	            DTColumnBuilder.newColumn('invoiceNo').withTitle('InvoiceNo'),
	            DTColumnBuilder.newColumn('origin').withTitle('Origin'),
	            DTColumnBuilder.newColumn('customerName').withTitle('CustomerName'),
	            DTColumnBuilder.newColumn('destination').withTitle('Destination'),
	            DTColumnBuilder.newColumn('truckNo').withTitle('TruckNo'),
	            DTColumnBuilder.newColumn('truckType').withTitle('TruckType'),
	            DTColumnBuilder.newColumn('noOfCase').withTitle('No of case'),
	            DTColumnBuilder.newColumn('opKms').withTitle('OP Kms'),
	            DTColumnBuilder.newColumn('clsKms').withTitle('Cls Kms'),
	            DTColumnBuilder.newColumn('totalkms').withTitle('Total kms'),
	            DTColumnBuilder.newColumn('forKms').withTitle('For Kms'),
	            DTColumnBuilder.newColumn('tRTypeFixed').withTitle('TRTypeFixed'),
	            DTColumnBuilder.newColumn('advance').withTitle('Advance')
	    ]; 
		 function toggleAll(selectAll, selectedItems) {
		        for (var id in selectedItems) {
		            if (selectedItems.hasOwnProperty(id)) {
		                selectedItems[id] = selectAll;
		            }
		        }
		    }
		 function toggleOne(selectedItems) {
		        for (var id in selectedItems) {
		            if (selectedItems.hasOwnProperty(id)) {
		                if(!selectedItems[id]) {
		                	bm.selectAll = false;
		                    return;
		                }
		            }
		        }
		        bm.selectAll = true;
		    }
}  */
</script>
</body>
</html>